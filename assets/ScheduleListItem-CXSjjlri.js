import{d as E,a as r,b as m,t as u,u as v,f as _,o,_ as A,M as W,N as X,c as b,r as K,w as O,z as C,D as V,F as N,C as S,A as T,O as Y,K as z,g as y,J as Z,G as ee,E as te,P as se,H as ae,p as ne}from"./index-Cx15TtZS.js";import{u as oe}from"./useEventData-C6iDhGDs.js";import{T as ie,F as re}from"./TagLabel-DDr9kjT6.js";import{N as le}from"./NoEntries-BPyCrKtn.js";const ce={class:"group-head"},de={class:"date-nav-container"},ue={key:1,class:"nav-arrow nav-left"},me=["id"],ge={key:3,class:"nav-arrow nav-right"},fe=E({__name:"DateHead",props:{date:{},index:{},sortedDateList:{},scrollToDate:{type:Function}},setup(p){return(l,h)=>(o(),r("div",ce,[m("div",de,[l.sortedDateList[l.index-1]?(o(),r("button",{key:0,class:"nav-arrow nav-left",onClick:h[0]||(h[0]=k=>l.scrollToDate(l.sortedDateList[l.index-1]))}," < ")):(o(),r("div",ue)),m("h2",{class:"head-date",id:l.date},u(v(_)(l.date,"Date Long")),9,me),l.sortedDateList[l.index+1]?(o(),r("button",{key:2,class:"nav-arrow nav-right",onClick:h[1]||(h[1]=k=>l.scrollToDate(l.sortedDateList[l.index+1]))}," > ")):(o(),r("div",ge))])]))}}),_e=A(fe,[["__scopeId","data-v-97f52d27"]]),he={},ve={class:"flow-btn"};function pe(p,l){return o(),r("button",ve,[W(p.$slots,"default",{},void 0)])}const De=A(he,[["render",pe],["__scopeId","data-v-e73f4560"]]),Te={class:"scroll-head schedule-list full-height"},ye={class:"scroll-y-area"},ke={class:"list-item-ul"},we={class:"list-item-info pad"},Ie={class:"list-item-name"},Le={key:0},$e={key:0},be={key:1},Ce={key:2},Ne={class:"list-item-tags"},Se=E({__name:"ScheduleListItem",props:{filters:{}},setup(p){const{t:l}=X();ne();const{scrollToDate:h}=Z(),k=b(()=>Object.keys(L.value).sort()),{performances:j,acts:D,stages:w}=oe(),H=p,R=e=>{const t=w.value.find(i=>i.id===e);return t?t.name:l("stageNotFound")},B=(e=[])=>te(e,D),I=b(()=>{const e=H.filters;return j.value.filter(t=>{var i;if(e.stages.length&&!e.stages.includes(String(t.stageID)))return!1;if(e.stageTypes.length){const s=w.value.find(c=>c.id===t.stageID);if(!s||!e.stageTypes.includes(s.type))return!1}if(e.perforTypes.length&&!e.perforTypes.includes(t.type)||e.performanceTags.length&&(!t.tags||!t.tags.some(s=>e.performanceTags.includes(s)))||e.categories.length&&!t.actsIDArr.map(n=>D.value.find(d=>d.id===n)).filter(Boolean).flatMap(n=>n.tags.map(d=>d.name)).some(n=>e.categories.includes(n))||e.actTypes.length&&!t.actsIDArr.some(c=>{const n=D.value.find(g=>g.id===c);return((n==null?void 0:n["act-type"])||[]).some(g=>e.actTypes.includes(g))})||e.actIDs.length&&!e.actIDs.some(s=>t.actsIDArr.includes(Number(s)))||e.performanceIDs.length&&!e.performanceIDs.some(s=>t.id===Number(s)))return!1;if(e.searchQuery){const s=e.searchQuery.toLowerCase(),c=(t.name||"").toLowerCase().includes(s)||(t.description||"").toLowerCase().includes(s),n=t.actsIDArr.some(a=>{var M,P;const f=D.value.find(J=>J.id===a);return((M=f==null?void 0:f.name)==null?void 0:M.toLowerCase().includes(s))||((P=f==null?void 0:f.description)==null?void 0:P.toLowerCase().includes(s))}),d=w.value.find(a=>a.id===t.stageID),g=(i=d==null?void 0:d.name)==null?void 0:i.toLowerCase().includes(s);if(!c&&!n&&!g)return!1}return!0}).sort(Q)});function Q(e,t){return new Date(e.start_time).getTime()-new Date(t.start_time).getTime()}const L=b(()=>{const e={};for(const t of I.value){const i=_(t.start_time,"ISO"),s=_(t.start_time,"Time");e[i]||(e[i]={}),e[i][s]||(e[i][s]=[]),e[i][s].push(t)}return e}),F=K({});function U(e,t,i){i&&(F.value[`${e}_${t}`]=i)}function q(){x()}const $=K(null);$.value=new Date("2025-07-25T17:00:00");function x(){const e=$.value??new Date,t=I.value.filter(n=>T(n.start_time).getTime()>=e.getTime()).sort((n,d)=>T(n.start_time).getTime()-T(d.start_time).getTime());if(t.length===0){console.log("No upcoming performances found.");return}const i=t[0],s=_(i.start_time,"ISO"),c=_(i.start_time,"Time");Y(()=>{const n=F.value[`${s}_${c}`];n?(console.log("Scroll to:",s,c),n.scrollIntoView({behavior:"smooth",block:"start"})):console.warn("Dont find Scroll-Target for:",s,c)})}function G(e){const t=$.value??new Date;return T(e.end_time).getTime()<t.getTime()}return(e,t)=>{const i=ae("router-link");return o(),r("div",Te,[m("div",ye,[I.value.length>1?(o(),O(De,{key:0,class:"flow-btn",onClick:q},{default:V(()=>[z(u(e.$t("now")),1)]),_:1})):C("",!0),Object.keys(L.value).length===0?(o(),O(le,{key:1,type:"event"})):C("",!0),(o(!0),r(N,null,S(L.value,(s,c,n)=>(o(),r("div",{key:c,class:"date-group"},[y(_e,{date:c,index:n,sortedDateList:k.value,scrollToDate:v(h)},null,8,["date","index","sortedDateList","scrollToDate"]),(o(!0),r(N,null,S(s,(d,g)=>(o(),r("div",{key:g,class:"time-group"},[m("h3",{class:"group-head head-time pad",ref_for:!0,ref:a=>U(c,g,a)},u(g),513),m("ul",ke,[(o(!0),r(N,null,S(d,a=>{var f;return o(),r("li",{key:a.id,class:ee(["list-item-obj",{"performance-past":G(a)}])},[y(i,{to:`/event/${((f=a["id-name"])==null?void 0:f.trim())||a.id}`,class:"list-item-link"},{default:V(()=>[m("div",we,[m("strong",Ie,[a.name?(o(),r("div",Le,[z(u(a.name)+" ",1),a.actsIDArr.length?(o(),r("span",$e," ("+u(B(a.actsIDArr))+") ",1)):C("",!0)])):a.actsIDArr.length?(o(),r("div",be,u(B(a.actsIDArr)),1)):(o(),r("div",Ce,u(e.$t("Unknown")),1))]),m("span",Ne,[m("span",null,u(R(a.stageID)),1),m("span",null,u(v(_)(a.start_time,"Date Long"))+", "+u(v(_)(a.start_time,"Time"))+" â€“ "+u(v(_)(a.end_time,"Time")),1),m("span",null,[y(ie,{name:v(se)(a.type),class:"tag-label-item"},null,8,["name"])])])])]),_:2},1032,["to"]),y(re,{itemId:a.id.toString(),itemType:"event",class:"list-item-fav-btn"},null,8,["itemId"])],2)}),128))])]))),128))]))),128))])])}}}),Pe=A(Se,[["__scopeId","data-v-1f0a5fac"]]);export{_e as D,Pe as S};
