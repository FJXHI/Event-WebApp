import{d as V,a as i,t as f,p as U,q as K,o as s,_ as B,r as P,c as T,b as e,F as I,s as A,u as W,v as L,w as X,x as Q,y as Y,z as m,g as M,A as G,B as J,C as Z,D as C,E as N,n as q,G as ee,H as te,J as se,f as ae}from"./index-DZnkpXaR.js";import{S as ne}from"./ScheduleListItem-C8FqGEwZ.js";import{u as z}from"./useEventData-CPEn0_oc.js";import{T as R}from"./tagLabel-CwaHyOvs.js";import{S as oe}from"./SearchBar-B9HW0xbH.js";import"./FavBtn-GjQ8IZsp.js";const le=V({__name:"SwitchView",props:{targetView:{}},setup(H){const y=H,h=U(),b=K(),S=()=>{h.replace({query:{...b.query,view:y.targetView}})};return(g,r)=>(s(),i("button",{onClick:S,class:"btn-view-chang"},f(g.$t("change-view")),1))}}),j=B(le,[["__scopeId","data-v-37e30bd6"]]),re={class:"overlay"},ie={class:"filter-modal"},ce={class:"filter-modal-header"},ue={class:"filter-modal-body"},de={class:"filter-group"},ve={class:"filter-button-group"},me=["onClick"],ge={class:"filter-group"},pe={class:"filter-button-group"},fe={class:"filter-group"},_e={class:"filter-button-group"},he={class:"filter-group"},ye={class:"filter-button-group"},Se={class:"filter-modal-footer"},$e=V({__name:"FilterMenu",props:{initialStages:{type:Array,default:()=>[]},initialCategories:{type:Array,default:()=>[]},initialTypes:{type:Array,default:()=>[]},initialPerformanceTags:{type:Array,default:()=>[]},initialSearchQuery:{type:String,default:""}},emits:["apply","close"],setup(H,{emit:y}){const h=y,{stages:b,acts:S,performances:g}=z(),r=H,p=P([...r.initialStages.map(Number)]),o=P([...r.initialCategories]),$=P([...r.initialTypes]),k=P([...r.initialPerformanceTags]),d=P(r.initialSearchQuery),w=T(()=>{const a=new Set;return S.value.forEach(_=>{var n;(n=_.tags)==null||n.forEach(E=>{E.visible&&a.add(E.name)})}),Array.from(a)}),l=T(()=>{const a=new Set;return g.value.forEach(_=>{_.type&&a.add(_.type)}),Array.from(a)}),c=T(()=>{const a=new Set;return g.value.forEach(_=>{var n;(n=_.tags)==null||n.forEach(E=>a.add(E))}),Array.from(a)}),u=(a,_)=>{const n=a.indexOf(_);n>=0?a.splice(n,1):a.push(_)},v=a=>u(p.value,a),t=a=>u(o.value,a),D=a=>u($.value,a),O=a=>u(k.value,a),x=()=>{p.value=[],o.value=[],$.value=[],k.value=[],d.value=""},F=()=>{h("apply",{stages:p.value.map(String),categories:o.value,types:$.value,performanceTags:k.value,searchQuery:d.value.trim()}),h("close")};return(a,_)=>(s(),i("div",re,[e("div",ie,[e("div",ce,[e("h2",null,f(a.$t("filter")),1),e("button",{onClick:_[0]||(_[0]=n=>a.$emit("close")),class:"filter-close-btn"},"Ã—")]),e("div",ue,[e("button",{onClick:x,class:"filter-reset-btn"}," â†» "+f(a.$t("reset-filter")),1),e("div",de,[e("h3",null,f(a.$t("stages")),1),e("div",ve,[(s(!0),i(I,null,A(W(b),n=>(s(),i("button",{key:n.id,onClick:E=>v(n.id),class:L({selected:p.value.includes(n.id)})},[_[1]||(_[1]=e("span",null,"ðŸ“",-1)),X(" "+f(n.name),1)],10,me))),128))])]),e("div",ge,[e("h3",null,f(a.$t("kategorien")),1),e("div",pe,[(s(!0),i(I,null,A(w.value,n=>(s(),Q(R,{key:n,name:n,tag:"button",onClick:E=>t(n),class:L({selected:o.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",fe,[e("h3",null,f(a.$t("Performance-Types")),1),e("div",_e,[(s(!0),i(I,null,A(l.value,n=>(s(),Q(R,{key:n,name:n,tag:"button",onClick:E=>D(n),class:L({selected:$.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",he,[e("h3",null,f(a.$t("Performance-Tags")),1),e("div",ye,[(s(!0),i(I,null,A(c.value,n=>(s(),Q(R,{key:n,name:n,tag:"button",onClick:E=>O(n),class:L({selected:k.value.includes(n)})},null,8,["name","onClick","class"]))),128))])])]),e("div",Se,[e("button",{onClick:F,class:"filter-apply-btn"},f(a.$t("apply-filter")),1)])])]))}}),ke=B($e,[["__scopeId","data-v-99d9e48d"]]),Te={class:"btn-header"},be=V({__name:"ScheduleList",setup(H){const{performances:y}=z(),h=K(),b=T(()=>h.query.search??"false"),S=T(()=>h.query.fav==="true"),g=P(!1),r=Y({stages:[],categories:[],types:[],performanceTags:[],searchQuery:""}),p=d=>{m.value.searchQuery=d,m.value.stages=[],m.value.categories=[],m.value.types=[],m.value.performanceTags=[],m.value.actIDs=[],m.value.performanceIDs=[]},o=d=>{m.value.stages=d.stages||[],m.value.categories=d.categories||[],m.value.types=d.types||[],m.value.performanceTags=d.performanceTags||[],m.value.searchQuery=d.searchQuery||"",m.value.actIDs=d.actIDs||[],m.value.performanceIDs=d.performanceIDs||[],r.stages=[...m.value.stages],r.categories=[...m.value.categories],r.types=[...m.value.types],r.performanceTags=[...m.value.performanceTags],r.searchQuery=m.value.searchQuery},$=T(()=>S.value?{...m.value,performanceIDs:k.value.map(d=>String(d.id))}:m.value),k=T(()=>{const d=JSON.parse(localStorage.getItem("event")||"[]");return!y.value||y.value.length===0?(console.warn("Performances data not available yet!"),[]):y.value.filter(w=>d.includes(w.id.toString()))});return(d,w)=>(s(),i("div",null,[e("div",null,[G(M(oe,{onApply:p},null,512),[[J,b.value==="true"]])]),e("div",Te,[g.value?(s(),Q(ke,{key:0,"initial-stages":r.stages,"initial-categories":r.categories,"initial-types":r.types,"initial-performance-tags":r.performanceTags,"initial-search-query":r.searchQuery,onApply:o,onClose:w[0]||(w[0]=l=>g.value=!1)},null,8,["initial-stages","initial-categories","initial-types","initial-performance-tags","initial-search-query"])):Z("",!0),M(j,{targetView:"table",class:"schedul-btn"}),e("button",{onClick:w[1]||(w[1]=l=>g.value=!0),class:"open-filter schedul-btn"},f(d.$t("open-filter")),1)]),M(ne,{filters:$.value,class:"ProgrammList"},null,8,["filters"])]))}}),De=B(be,[["__scopeId","data-v-f21c754a"]]),we={class:"table-content"},Ce={class:"timeline"},Ie={class:"timeline-column"},Ae={class:"timeline-header"},He={class:"stages"},Ee={class:"timeline-header"},Me={key:0},Pe={key:1},Ve={key:2},qe=V({__name:"ScheduleTableItem",props:{date:String},setup(H){const y=H,{performances:h,acts:b,stages:S}=z(),g=l=>te(l,b),r=T(()=>h.value.filter(l=>{const c=C(l.start_time),u=C(y.date),v=c.getHours()<N&&c.getDate()===u.getDate()+1,D=c.getDate()===u.getDate()||v;return c.getHours()<N&&c.getDate()===u.getDate()?!1:D}).sort((l,c)=>{const u=C(l.start_time)??new Date(0),v=C(c.start_time)??new Date(0);return u.getTime()-v.getTime()})),p=T(()=>S.value.filter(l=>r.value.some(c=>c.stageID===l.id))),o=T(()=>{const c=r.value.flatMap(t=>[C(t.start_time).getHours(),C(t.end_time).getHours()]).map(t=>t<N?t+24:t),u=Math.min(...c)-1,v=Math.max(...c)+1;return Array.from({length:v-u+1},(t,D)=>(u+D)%24)}),$=l=>{const c=C(l.start_time),u=C(l.end_time),v=o.value[0],t=o.value.length*60,D=(c.getHours()<v?c.getHours()+24:c.getHours())*60+c.getMinutes()-v*60,O=(u.getHours()<v?u.getHours()+24:u.getHours())*60+u.getMinutes()-v*60,x=D/t*100,F=(O-D)/t*100,a=1,_=o.value.length*60,n=a/_*100;return{top:`${x}%`,height:`calc(${F}% - ${n}%)`}},k=()=>{const l=o.value[0];return{height:`${((o.value[o.value.length-1]<l?o.value[o.value.length-1]+24:o.value[o.value.length-1])-l+1)*60}px`}},d=l=>{const c=o.value[0],u=o.value.length*60;return{top:((l<c?l+24:l)*60-c*60)/u*100+"%"}},w=l=>["concert","spezial","workshop","Musik","Kunst","Gesellschaft","Sport","Wirtschaft"].includes(l)?l:"default";return(l,c)=>{const u=se("router-link");return s(),i("div",we,[e("div",Ce,[e("div",Ie,[e("div",Ae,f(l.$t("Time")),1),e("div",{class:"time-slots",style:q(k())},[(s(!0),i(I,null,A(o.value,v=>(s(),i("div",{key:v,class:"time-slot",style:q(d(v))},f(v%24)+":00 ",5))),128))],4)])]),e("div",He,[(s(!0),i(I,null,A(p.value,v=>(s(),i("div",{key:v.id,class:"stage"},[e("div",Ee,f(v.name),1),e("div",{class:"events",style:q(k())},[(s(!0),i(I,null,A(o.value,t=>(s(),i("div",{key:t,class:"time-slot",style:q(d(t))},null,4))),128)),(s(!0),i(I,null,A(r.value.filter(t=>t.stageID===v.id),t=>{var D;return s(),Q(u,{key:t.id,to:"/event/"+(((D=t["id-name"])==null?void 0:D.trim())||t.id),class:L(["event",w(t==null?void 0:t.type)]),style:q($(t)),title:t.name||g(t.actsIDArr)||l.$t("Unknown")},{default:ee(()=>[e("strong",null,[t.name?(s(),i("div",Me,f(t.name),1)):t.actsIDArr.length?(s(),i("div",Pe,f(g(t.actsIDArr)),1)):(s(),i("div",Ve,f(l.$t("Unknown")),1))])]),_:2},1032,["to","class","style","title"])}),128))],4)]))),128))])])}}}),Le=B(qe,[["__scopeId","data-v-a9a8767a"]]),Qe={class:"timetable"},Be={class:"group-head"},Ne={class:"date-nav-container"},ze=["onClick"],Oe={key:1,class:"nav-arrow nav-left"},xe=["id"],Fe=["onClick"],Re={key:3,class:"nav-arrow nav-right"},Ge=V({__name:"ScheduleTable",setup(H){const y=U();function h(g){y.replace({hash:`#${g}`,query:{...y.currentRoute.value.query}});const r=document.getElementById(g);r&&r.scrollIntoView({behavior:"smooth"})}const{performances:b}=z(),S=T(()=>{const g=new Set(b.value.map(p=>C(p.start_time).toLocaleDateString("en-CA"))),r=new Set;return b.value.forEach(p=>{const o=C(p.start_time),$=o.getHours();if($>=0&&$<N){const k=new Date(o);k.setDate(o.getDate()-1),r.add(k.toLocaleDateString("en-CA"))}}),Array.from(new Set([...g,...r])).sort()});return(g,r)=>(s(),i(I,null,[M(j,{targetView:"list"}),e("div",Qe,[(s(!0),i(I,null,A(S.value,(p,o)=>(s(),i("div",{key:p,class:"day-table"},[e("div",Be,[e("div",Ne,[o>0?(s(),i("button",{key:0,class:"nav-arrow nav-left",onClick:$=>h(S.value[o-1])}," < ",8,ze)):(s(),i("div",Oe)),e("h2",{class:"head-date",id:p},f(W(ae)(p,"Date Long")),9,xe),o<S.value.length-1?(s(),i("button",{key:2,class:"nav-arrow nav-right",onClick:$=>h(S.value[o+1])}," > ",8,Fe)):(s(),i("div",Re))])]),M(Le,{date:p},null,8,["date"])]))),128))])],64))}}),Je=B(Ge,[["__scopeId","data-v-708cb6ff"]]),Ze=V({__name:"ScheduleView",setup(H){const y=K();U();const h=T(()=>y.query.view??"list");return(b,S)=>(s(),i("div",null,[G(e("div",null,[M(De)],512),[[J,h.value==="list"]]),G(e("div",null,[M(Je)],512),[[J,h.value==="table"]])]))}});export{Ze as default};
