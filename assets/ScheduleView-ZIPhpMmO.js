import{d as E,c as o,t as _,f as K,g as j,o as l,_ as V,r as M,b as I,a as e,F as T,h as w,u as G,i as Q,j as X,k as L,w as q,e as A,l as Y,v as Z,m as ee,p as R,q as te,n as P,s as se,x as ae}from"./index-D8q-9Edq.js";import{u as J,e as m,p as b,d as x,g as ne}from"./useEventData-emzBeDna.js";import{S as le}from"./ScheduleListItem-565VnTDy.js";import{T as U}from"./tagLabel-BsM9IHfm.js";import"./FavBtn-Dex-ilpC.js";const oe=E({__name:"SwitchView",props:{targetView:{}},setup(D){const f=D,h=K(),g=j(),r=()=>{h.replace({query:{...g.query,view:f.targetView}})};return(v,p)=>(l(),o("button",{onClick:r,class:"btn-view-chang"},_(v.$t("change-view")),1))}}),W=V(oe,[["__scopeId","data-v-37e30bd6"]]),re={class:"overlay"},ie={class:"filter-modal"},ce={class:"filter-modal-header"},ue={class:"filter-modal-body"},de={class:"filter-group"},me={class:"filter-button-group"},ve=["onClick"],pe={class:"filter-group"},ge={class:"filter-button-group"},_e={class:"filter-group"},he={class:"filter-button-group"},fe={class:"filter-group"},ye={class:"filter-button-group"},$e={class:"filter-modal-footer"},Se=E({__name:"FilterMenu",props:{initialStages:{type:Array,default:()=>[]},initialCategories:{type:Array,default:()=>[]},initialTypes:{type:Array,default:()=>[]},initialPerformanceTags:{type:Array,default:()=>[]},initialSearchQuery:{type:String,default:""}},emits:["apply","close"],setup(D,{emit:f}){const h=f,{stages:g,acts:r,performances:v}=J(),p=D,t=M([...p.initialStages.map(Number)]),y=M([...p.initialCategories]),k=M([...p.initialTypes]),H=M([...p.initialPerformanceTags]),i=M(p.initialSearchQuery),c=I(()=>{const a=new Set;return r.value.forEach($=>{var n;(n=$.tags)==null||n.forEach(C=>{C.visible&&a.add(C.name)})}),Array.from(a)}),d=I(()=>{const a=new Set;return v.value.forEach($=>{$.type&&a.add($.type)}),Array.from(a)}),u=I(()=>{const a=new Set;return v.value.forEach($=>{var n;(n=$.tags)==null||n.forEach(C=>a.add(C))}),Array.from(a)}),s=(a,$)=>{const n=a.indexOf($);n>=0?a.splice(n,1):a.push($)},S=a=>s(t.value,a),B=a=>s(y.value,a),N=a=>s(k.value,a),z=a=>s(H.value,a),O=()=>{t.value=[],y.value=[],k.value=[],H.value=[],i.value=""},F=()=>{h("apply",{stages:t.value.map(String),categories:y.value,types:k.value,performanceTags:H.value,searchQuery:i.value.trim()}),h("close")};return(a,$)=>(l(),o("div",re,[e("div",ie,[e("div",ce,[e("h2",null,_(a.$t("filter")),1),e("button",{onClick:$[0]||($[0]=n=>a.$emit("close")),class:"filter-close-btn"},"×")]),e("div",ue,[e("button",{onClick:O,class:"filter-reset-btn"}," ↻ "+_(a.$t("reset-filter")),1),e("div",de,[e("h3",null,_(a.$t("stages")),1),e("div",me,[(l(!0),o(T,null,w(G(g),n=>(l(),o("button",{key:n.id,onClick:C=>S(n.id),class:Q({selected:t.value.includes(n.id)})},[$[1]||($[1]=e("span",null,"📍",-1)),X(" "+_(n.name),1)],10,ve))),128))])]),e("div",pe,[e("h3",null,_(a.$t("kategorien")),1),e("div",ge,[(l(!0),o(T,null,w(c.value,n=>(l(),L(U,{key:n,name:n,tag:"button",onClick:C=>B(n),class:Q({selected:y.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",_e,[e("h3",null,_(a.$t("Performance-Types")),1),e("div",he,[(l(!0),o(T,null,w(d.value,n=>(l(),L(U,{key:n,name:n,tag:"button",onClick:C=>N(n),class:Q({selected:k.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",fe,[e("h3",null,_(a.$t("Performance-Tags")),1),e("div",ye,[(l(!0),o(T,null,w(u.value,n=>(l(),L(U,{key:n,name:n,tag:"button",onClick:C=>z(n),class:Q({selected:H.value.includes(n)})},null,8,["name","onClick","class"]))),128))])])]),e("div",$e,[e("button",{onClick:F,class:"filter-apply-btn"},_(a.$t("apply-filter")),1)])])]))}}),be=V(Se,[["__scopeId","data-v-99d9e48d"]]),Te={class:"search-bar"},De={class:"search-inputline"},ke={class:"search-icon"},we=["placeholder"],Ce=E({__name:"SearchBar",emits:["apply"],setup(D,{emit:f}){const h=f,g=M(""),r=()=>{h("apply",g.value)};return(v,p)=>(l(),o("div",Te,[e("div",De,[e("div",ke,[A(Y,{class:"icon-size"})]),q(e("input",{type:"text","onUpdate:modelValue":p[0]||(p[0]=t=>g.value=t),onInput:r,placeholder:v.$t("search-placeholder")},null,40,we),[[Z,g.value]])])]))}}),Ie=V(Ce,[["__scopeId","data-v-e8aa6883"]]),Ae={class:"btn-header"},He=E({__name:"ScheduleList",setup(D){const f=j(),h=I(()=>f.query.search??"false"),g=M(!1),r=ee({stages:[],categories:[],types:[],performanceTags:[],searchQuery:""}),v=t=>{m.value.searchQuery=t,m.value.stages=[],m.value.categories=[],m.value.types=[],m.value.performanceTags=[],m.value.actIDs=[],m.value.performanceIDs=[]},p=t=>{m.value.stages=t.stages||[],m.value.categories=t.categories||[],m.value.types=t.types||[],m.value.performanceTags=t.performanceTags||[],m.value.searchQuery=t.searchQuery||"",m.value.actIDs=t.actIDs||[],m.value.performanceIDs=t.performanceIDs||[],r.stages=[...m.value.stages],r.categories=[...m.value.categories],r.types=[...m.value.types],r.performanceTags=[...m.value.performanceTags],r.searchQuery=m.value.searchQuery};return(t,y)=>(l(),o("div",null,[e("div",null,[q(A(Ie,{onApply:v},null,512),[[R,h.value==="true"]])]),e("div",Ae,[g.value?(l(),L(be,{key:0,"initial-stages":r.stages,"initial-categories":r.categories,"initial-types":r.types,"initial-performance-tags":r.performanceTags,"initial-search-query":r.searchQuery,onApply:p,onClose:y[0]||(y[0]=k=>g.value=!1)},null,8,["initial-stages","initial-categories","initial-types","initial-performance-tags","initial-search-query"])):te("",!0),A(W,{targetView:"table",class:"schedul-btn"}),e("button",{onClick:y[1]||(y[1]=k=>g.value=!0),class:"open-filter schedul-btn"},_(t.$t("open-filter")),1)]),A(le,{filters:G(m),class:"ProgrammList"},null,8,["filters"])]))}}),Me=V(He,[["__scopeId","data-v-3797a104"]]),Ee={class:"table-content"},Ve={class:"timeline"},Pe={class:"timeline-column"},Qe={class:"timeline-header"},Le={class:"stages"},xe={class:"timeline-header"},qe={key:0},Be={key:1},Ne={key:2},ze=E({__name:"ScheduleTableItem",props:{date:String},setup(D){const f=D,{performances:h,acts:g,stages:r}=J(),v=i=>ne(i,g),p=I(()=>h.value.filter(i=>{const c=b(i.start_time),d=b(f.date),u=c.getHours()<x&&c.getDate()===d.getDate()+1,S=c.getDate()===d.getDate()||u;return c.getHours()<x&&c.getDate()===d.getDate()?!1:S}).sort((i,c)=>{const d=b(i.start_time)??new Date(0),u=b(c.start_time)??new Date(0);return d.getTime()-u.getTime()})),t=I(()=>{const c=p.value.flatMap(s=>[b(s.start_time).getHours(),b(s.end_time).getHours()]).map(s=>s<x?s+24:s),d=Math.min(...c)-1,u=Math.max(...c)+1;return Array.from({length:u-d+1},(s,S)=>(d+S)%24)}),y=i=>{const c=b(i.start_time),d=b(i.end_time),u=t.value[0],s=t.value.length*60,S=(c.getHours()<u?c.getHours()+24:c.getHours())*60+c.getMinutes()-u*60,B=(d.getHours()<u?d.getHours()+24:d.getHours())*60+d.getMinutes()-u*60,N=S/s*100,z=(B-S)/s*100,O=1,F=t.value.length*60,a=O/F*100;return{top:`${N}%`,height:`calc(${z}% - ${a}%)`}},k=()=>{const i=t.value[0];return{height:`${((t.value[t.value.length-1]<i?t.value[t.value.length-1]+24:t.value[t.value.length-1])-i+1)*60}px`}},H=i=>{const c=t.value[0],d=t.value.length*60;return{top:((i<c?i+24:i)*60-c*60)/d*100+"%"}};return(i,c)=>{const d=ae("router-link");return l(),o("div",Ee,[e("div",Ve,[e("div",Pe,[e("div",Qe,_(i.$t("Time")),1),e("div",{class:"time-slots",style:P(k())},[(l(!0),o(T,null,w(t.value,u=>(l(),o("div",{key:u,class:"time-slot",style:P(H(u))},_(u%24)+":00 ",5))),128))],4)])]),e("div",Le,[(l(!0),o(T,null,w(G(r),u=>(l(),o("div",{key:u.id,class:"stage"},[e("div",xe,_(u.name),1),e("div",{class:"events",style:P(k())},[(l(!0),o(T,null,w(t.value,s=>(l(),o("div",{key:s,class:"time-slot",style:P(H(s))},null,4))),128)),(l(!0),o(T,null,w(p.value.filter(s=>s.stageID===u.id),s=>{var S;return l(),L(d,{key:s.id,to:"/event/"+(((S=s["id-name"])==null?void 0:S.trim())||s.id),class:Q(["event",(s==null?void 0:s.type)||"default"]),style:P(y(s)),title:s.name||v(s.actsIDArr)||i.$t("Unknown")},{default:se(()=>[e("strong",null,[s.name?(l(),o("div",qe,_(s.name),1)):s.actsIDArr.length?(l(),o("div",Be,_(v(s.actsIDArr)),1)):(l(),o("div",Ne,_(i.$t("Unknown")),1))])]),_:2},1032,["to","class","style","title"])}),128))],4)]))),128))])])}}}),Oe=V(ze,[["__scopeId","data-v-9833b85d"]]),Fe={class:"timetable"},Ue={class:"day-head"},Re=E({__name:"ScheduleTable",setup(D){const{performances:f}=J(),h=I(()=>{const g=new Set(f.value.map(v=>b(v.start_time).toLocaleDateString("en-CA"))),r=new Set;return f.value.forEach(v=>{const p=b(v.start_time),t=p.getHours();if(t>=0&&t<x){const y=new Date(p);y.setDate(p.getDate()-1),r.add(y.toLocaleDateString("en-CA"))}}),Array.from(new Set([...g,...r])).sort()});return(g,r)=>(l(),o(T,null,[A(W,{targetView:"list"}),e("div",Fe,[(l(!0),o(T,null,w(h.value,v=>(l(),o("div",{key:v,class:"day-table"},[e("h2",Ue,_(v),1),A(Oe,{date:v},null,8,["date"])]))),128))])],64))}}),je=V(Re,[["__scopeId","data-v-85bb89a6"]]),Ye=E({__name:"ScheduleView",setup(D){const f=j();K();const h=I(()=>f.query.view??"list");return(g,r)=>(l(),o("div",null,[q(e("div",null,[A(Me)],512),[[R,h.value==="list"]]),q(e("div",null,[A(je)],512),[[R,h.value==="table"]])]))}});export{Ye as default};
