import{d as A,c as r,t as v,f as F,g as O,o as n,_ as E,r as M,b as C,a as e,F as b,h as k,u as U,i as L,j as K,w as q,e as I,k as W,v as X,l as z,m as R,p as Y,n as B,q as Z,s as ee}from"./index-Cdaev5QM.js";import{u as j,e as h,p as D,d as P}from"./useEventData-CJiLa8jm.js";import{S as te}from"./ScheduleListItem-B5Ci6ZHt.js";import"./FavBtn-Cmrpq5Yq.js";import"./tagLabel-DiCZHeMZ.js";const se=A({__name:"SwitchView",props:{targetView:{}},setup(T){const g=T,p=F(),_=O(),f=()=>{p.replace({query:{..._.query,view:g.targetView}})};return(m,l)=>(n(),r("button",{onClick:f,class:"btn-view-chang"},v(m.$t("change-view")),1))}}),G=E(se,[["__scopeId","data-v-4f880236"]]),ae={class:"overlay"},ne={class:"filter-modal"},oe={class:"filter-modal-header"},le={class:"filter-modal-body"},re={class:"filter-group"},ce={class:"filter-button-group"},ie=["onClick"],ue={class:"filter-group"},de={class:"filter-button-group"},ve=["onClick"],me={class:"filter-group"},_e={class:"filter-button-group"},pe=["onClick"],he={class:"filter-group"},ge={class:"filter-button-group"},fe=["onClick"],ye={class:"filter-modal-footer"},$e=A({__name:"FilterMenu",emits:["apply","close"],setup(T,{emit:g}){const p=g,{stages:_,acts:f,performances:m}=j(),l=M([]),o=M([]),$=M([]),H=M([]),V=M(""),d=C(()=>{const s=new Set;return f.value.forEach(y=>{var a;(a=y.tags)==null||a.forEach(w=>{w.visible&&s.add(w.name)})}),Array.from(s)}),i=C(()=>{const s=new Set;return m.value.forEach(y=>{y.type&&s.add(y.type)}),Array.from(s)}),u=C(()=>{const s=new Set;return m.value.forEach(y=>{var a;(a=y.tags)==null||a.forEach(w=>s.add(w))}),Array.from(s)}),c=(s,y)=>{const a=s.indexOf(y);a>=0?s.splice(a,1):s.push(y)},t=s=>c(l.value,s),S=s=>c(o.value,s),x=s=>c($.value,s),N=s=>c(H.value,s),Q=()=>{l.value=[],o.value=[],$.value=[],H.value=[],V.value=""},J=()=>{p("apply",{stages:l.value.map(String),categories:o.value,types:$.value,performanceTags:H.value,searchQuery:V.value.trim()}),p("close")};return(s,y)=>(n(),r("div",ae,[e("div",ne,[e("div",oe,[e("h2",null,v(s.$t("filter")),1),e("button",{onClick:y[0]||(y[0]=a=>s.$emit("close")),class:"filter-close-btn"},"×")]),e("div",le,[e("button",{onClick:Q,class:"filter-reset-btn"}," ↻ "+v(s.$t("reset-filter")),1),e("div",re,[e("h3",null,v(s.$t("stages")),1),e("div",ce,[(n(!0),r(b,null,k(U(_),a=>(n(),r("button",{key:a.id,onClick:w=>t(a.id),class:L({selected:l.value.includes(a.id)})},[y[1]||(y[1]=e("span",null,"📍",-1)),K(" "+v(a.name),1)],10,ie))),128))])]),e("div",ue,[e("h3",null,v(s.$t("kategorien")),1),e("div",de,[(n(!0),r(b,null,k(d.value,a=>(n(),r("button",{key:a,onClick:w=>S(a),class:L({selected:o.value.includes(a)})},v(a),11,ve))),128))])]),e("div",me,[e("h3",null,v(s.$t("Performance-Types")),1),e("div",_e,[(n(!0),r(b,null,k(i.value,a=>(n(),r("button",{key:a,onClick:w=>x(a),class:L({selected:$.value.includes(a)})},v(a),11,pe))),128))])]),e("div",he,[e("h3",null,v(s.$t("Performance-Tags")),1),e("div",ge,[(n(!0),r(b,null,k(u.value,a=>(n(),r("button",{key:a,onClick:w=>N(a),class:L({selected:H.value.includes(a)})},v(a),11,fe))),128))])])]),e("div",ye,[e("button",{onClick:J,class:"filter-apply-btn"},v(s.$t("apply-filter")),1)])])]))}}),Se=E($e,[["__scopeId","data-v-75bebed1"]]),De={class:"search-bar"},be={class:"search-inputline"},ke={class:"search-icon"},Te=["placeholder"],we=A({__name:"SearchBar",emits:["apply"],setup(T,{emit:g}){const p=g,_=M(""),f=()=>{p("apply",_.value)};return(m,l)=>(n(),r("div",De,[e("div",be,[e("div",ke,[I(W,{class:"icon-size"})]),q(e("input",{type:"text","onUpdate:modelValue":l[0]||(l[0]=o=>_.value=o),onInput:f,placeholder:m.$t("search-placeholder")},null,40,Te),[[X,_.value]])])]))}}),Ce=E(we,[["__scopeId","data-v-e8aa6883"]]),Ie={class:"btn-header"},He=A({__name:"ScheduleList",setup(T){const g=O(),p=C(()=>g.query.search??"false"),_=M(!1),f=l=>{h.value.searchQuery=l,h.value.stages=[],h.value.categories=[],h.value.types=[],h.value.performanceTags=[],h.value.actIDs=[],h.value.performanceIDs=[]},m=l=>{h.value.stages=l.stages||[],h.value.categories=l.categories||[],h.value.types=l.types||[],h.value.performanceTags=l.performanceTags||[],h.value.searchQuery=l.searchQuery||"",h.value.actIDs=l.actIDs||[],h.value.performanceIDs=l.performanceIDs||[]};return(l,o)=>(n(),r("div",null,[e("div",null,[q(I(Ce,{onApply:f},null,512),[[z,p.value==="true"]])]),e("div",Ie,[_.value?(n(),R(Se,{key:0,onApply:m,onClose:o[0]||(o[0]=$=>_.value=!1)})):Y("",!0),I(G,{targetView:"table"}),e("button",{onClick:o[1]||(o[1]=$=>_.value=!0),class:"open-filter"},v(l.$t("open-filter")),1)]),I(te,{filters:U(h),class:"ProgrammList"},null,8,["filters"])]))}}),Me=E(He,[["__scopeId","data-v-b4f67fad"]]),Ae={class:"table-content"},Ee={class:"timeline"},Ve={class:"timeline-column"},Be={class:"timeline-header"},Le={class:"stages"},Pe={class:"timeline-header"},qe={key:0},xe={key:1},Ne={key:2},Qe=A({__name:"ScheduleTableItem",props:{date:String},setup(T){const g=T,{performances:p,acts:_,stages:f}=j(),m=(d=[])=>d.map(i=>{var u;return((u=_.value.find(c=>c.id===i))==null?void 0:u.name)||"Unknown Artist"}).join(", "),l=C(()=>p.value.filter(d=>{const i=D(d.start_time),u=D(g.date),c=i.getHours()<P&&i.getDate()===u.getDate()+1,S=i.getDate()===u.getDate()||c;return i.getHours()<P&&i.getDate()===u.getDate()?!1:S}).sort((d,i)=>{const u=D(d.start_time)??new Date(0),c=D(i.start_time)??new Date(0);return u.getTime()-c.getTime()})),o=C(()=>{const i=l.value.flatMap(t=>[D(t.start_time).getHours(),D(t.end_time).getHours()]).map(t=>t<P?t+24:t),u=Math.min(...i)-1,c=Math.max(...i)+1;return Array.from({length:c-u+1},(t,S)=>(u+S)%24)}),$=d=>{const i=D(d.start_time),u=D(d.end_time),c=o.value[0],t=o.value.length*60,S=(i.getHours()<c?i.getHours()+24:i.getHours())*60+i.getMinutes()-c*60,x=(u.getHours()<c?u.getHours()+24:u.getHours())*60+u.getMinutes()-c*60,N=S/t*100+"%",Q=(x-S)/t*100+"%";return{top:N,height:Q}},H=()=>{const d=o.value[0];return{height:`${((o.value[o.value.length-1]<d?o.value[o.value.length-1]+24:o.value[o.value.length-1])-d+1)*60}px`}},V=d=>{const i=o.value[0],u=o.value.length*60;return{top:((d<i?d+24:d)*60-i*60)/u*100+"%"}};return(d,i)=>{const u=ee("router-link");return n(),r("div",Ae,[e("div",Ee,[e("div",Ve,[e("div",Be,v(d.$t("Time")),1),e("div",{class:"time-slots",style:B(H())},[(n(!0),r(b,null,k(o.value,c=>(n(),r("div",{key:c,class:"time-slot",style:B(V(c))},v(c%24)+":00 ",5))),128))],4)])]),e("div",Le,[(n(!0),r(b,null,k(U(f),c=>(n(),r("div",{key:c.id,class:"stage"},[e("div",Pe,v(c.name),1),e("div",{class:"events",style:B(H())},[(n(!0),r(b,null,k(o.value,t=>(n(),r("div",{key:t,class:"time-slot",style:B(V(t))},null,4))),128)),(n(!0),r(b,null,k(l.value.filter(t=>t.stageID===c.id),t=>{var S;return n(),R(u,{key:t.id,to:"/event/"+(((S=t["id-name"])==null?void 0:S.trim())||t.id),class:"event",style:B($(t)),title:t.name||m(t.actsIDArr)||d.$t("Unknown")},{default:Z(()=>[e("strong",null,[t.name?(n(),r("div",qe,v(t.name),1)):t.actsIDArr.length?(n(),r("div",xe,v(m(t.actsIDArr)),1)):(n(),r("div",Ne,v(d.$t("Unknown")),1))])]),_:2},1032,["to","style","title"])}),128))],4)]))),128))])])}}}),ze=E(Qe,[["__scopeId","data-v-43ae1c7d"]]),Oe={class:"timetable"},Ue={class:"day-head"},je=A({__name:"ScheduleTable",setup(T){const{performances:g}=j(),p=C(()=>{const _=new Set(g.value.map(m=>D(m.start_time).toLocaleDateString("en-CA"))),f=new Set;return g.value.forEach(m=>{const l=D(m.start_time),o=l.getHours();if(o>=0&&o<P){const $=new Date(l);$.setDate(l.getDate()-1),f.add($.toLocaleDateString("en-CA"))}}),Array.from(new Set([..._,...f])).sort()});return(_,f)=>(n(),r(b,null,[I(G,{targetView:"list"}),e("div",Oe,[(n(!0),r(b,null,k(p.value,m=>(n(),r("div",{key:m,class:"day-table"},[e("h2",Ue,v(m),1),I(ze,{date:m},null,8,["date"])]))),128))])],64))}}),Fe=E(je,[["__scopeId","data-v-71dec07e"]]),Xe=A({__name:"ScheduleView",setup(T){const g=O();F();const p=C(()=>g.query.view??"list");return(_,f)=>(n(),r("div",null,[q(e("div",null,[I(Me)],512),[[z,p.value==="list"]]),q(e("div",null,[I(Fe)],512),[[z,p.value==="table"]])]))}});export{Xe as default};
