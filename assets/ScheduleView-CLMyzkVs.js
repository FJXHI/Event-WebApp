import{d as E,a as c,t as p,k as K,l as j,o,_ as L,r as M,c as A,b as e,F as $,m as D,u as G,p as V,q as X,s as Q,v as Y,e as I,w as R,x as U,y as Z,n as P,z as ee,A as te}from"./index-BIkOLR_Z.js";import{e as m,p as T,d as N,g as se}from"./config-tdt0jHZW.js";import{S as ae}from"./ScheduleListItem-Den88hGV.js";import{u as J}from"./useEventData-CE4THbyF.js";import{T as F}from"./tagLabel-D31F0LEb.js";import{S as ne}from"./SearchBar-DOqd5MZV.js";import"./FavBtn-CvnfJoFt.js";const oe=E({__name:"SwitchView",props:{targetView:{}},setup(w){const S=w,h=K(),y=j(),u=()=>{h.replace({query:{...y.query,view:S.targetView}})};return(v,f)=>(o(),c("button",{onClick:u,class:"btn-view-chang"},p(v.$t("change-view")),1))}}),W=L(oe,[["__scopeId","data-v-37e30bd6"]]),le={class:"overlay"},re={class:"filter-modal"},ie={class:"filter-modal-header"},ce={class:"filter-modal-body"},ue={class:"filter-group"},de={class:"filter-button-group"},me=["onClick"],ve={class:"filter-group"},pe={class:"filter-button-group"},ge={class:"filter-group"},fe={class:"filter-button-group"},_e={class:"filter-group"},he={class:"filter-button-group"},ye={class:"filter-modal-footer"},Se=E({__name:"FilterMenu",props:{initialStages:{type:Array,default:()=>[]},initialCategories:{type:Array,default:()=>[]},initialTypes:{type:Array,default:()=>[]},initialPerformanceTags:{type:Array,default:()=>[]},initialSearchQuery:{type:String,default:""}},emits:["apply","close"],setup(w,{emit:S}){const h=S,{stages:y,acts:u,performances:v}=J(),f=w,t=M([...f.initialStages.map(Number)]),_=M([...f.initialCategories]),k=M([...f.initialTypes]),H=M([...f.initialPerformanceTags]),q=M(f.initialSearchQuery),l=A(()=>{const a=new Set;return u.value.forEach(g=>{var n;(n=g.tags)==null||n.forEach(C=>{C.visible&&a.add(C.name)})}),Array.from(a)}),i=A(()=>{const a=new Set;return v.value.forEach(g=>{g.type&&a.add(g.type)}),Array.from(a)}),d=A(()=>{const a=new Set;return v.value.forEach(g=>{var n;(n=g.tags)==null||n.forEach(C=>a.add(C))}),Array.from(a)}),r=(a,g)=>{const n=a.indexOf(g);n>=0?a.splice(n,1):a.push(g)},s=a=>r(t.value,a),b=a=>r(_.value,a),x=a=>r(k.value,a),B=a=>r(H.value,a),z=()=>{t.value=[],_.value=[],k.value=[],H.value=[],q.value=""},O=()=>{h("apply",{stages:t.value.map(String),categories:_.value,types:k.value,performanceTags:H.value,searchQuery:q.value.trim()}),h("close")};return(a,g)=>(o(),c("div",le,[e("div",re,[e("div",ie,[e("h2",null,p(a.$t("filter")),1),e("button",{onClick:g[0]||(g[0]=n=>a.$emit("close")),class:"filter-close-btn"},"×")]),e("div",ce,[e("button",{onClick:z,class:"filter-reset-btn"}," ↻ "+p(a.$t("reset-filter")),1),e("div",ue,[e("h3",null,p(a.$t("stages")),1),e("div",de,[(o(!0),c($,null,D(G(y),n=>(o(),c("button",{key:n.id,onClick:C=>s(n.id),class:V({selected:t.value.includes(n.id)})},[g[1]||(g[1]=e("span",null,"📍",-1)),X(" "+p(n.name),1)],10,me))),128))])]),e("div",ve,[e("h3",null,p(a.$t("kategorien")),1),e("div",pe,[(o(!0),c($,null,D(l.value,n=>(o(),Q(F,{key:n,name:n,tag:"button",onClick:C=>b(n),class:V({selected:_.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",ge,[e("h3",null,p(a.$t("Performance-Types")),1),e("div",fe,[(o(!0),c($,null,D(i.value,n=>(o(),Q(F,{key:n,name:n,tag:"button",onClick:C=>x(n),class:V({selected:k.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",_e,[e("h3",null,p(a.$t("Performance-Tags")),1),e("div",he,[(o(!0),c($,null,D(d.value,n=>(o(),Q(F,{key:n,name:n,tag:"button",onClick:C=>B(n),class:V({selected:H.value.includes(n)})},null,8,["name","onClick","class"]))),128))])])]),e("div",ye,[e("button",{onClick:O,class:"filter-apply-btn"},p(a.$t("apply-filter")),1)])])]))}}),be=L(Se,[["__scopeId","data-v-99d9e48d"]]),Te={class:"btn-header"},$e=E({__name:"ScheduleList",setup(w){const S=j(),h=A(()=>S.query.search??"false"),y=M(!1),u=Y({stages:[],categories:[],types:[],performanceTags:[],searchQuery:""}),v=t=>{m.value.searchQuery=t,m.value.stages=[],m.value.categories=[],m.value.types=[],m.value.performanceTags=[],m.value.actIDs=[],m.value.performanceIDs=[]},f=t=>{m.value.stages=t.stages||[],m.value.categories=t.categories||[],m.value.types=t.types||[],m.value.performanceTags=t.performanceTags||[],m.value.searchQuery=t.searchQuery||"",m.value.actIDs=t.actIDs||[],m.value.performanceIDs=t.performanceIDs||[],u.stages=[...m.value.stages],u.categories=[...m.value.categories],u.types=[...m.value.types],u.performanceTags=[...m.value.performanceTags],u.searchQuery=m.value.searchQuery};return(t,_)=>(o(),c("div",null,[e("div",null,[R(I(ne,{onApply:v},null,512),[[U,h.value==="true"]])]),e("div",Te,[y.value?(o(),Q(be,{key:0,"initial-stages":u.stages,"initial-categories":u.categories,"initial-types":u.types,"initial-performance-tags":u.performanceTags,"initial-search-query":u.searchQuery,onApply:f,onClose:_[0]||(_[0]=k=>y.value=!1)},null,8,["initial-stages","initial-categories","initial-types","initial-performance-tags","initial-search-query"])):Z("",!0),I(W,{targetView:"table",class:"schedul-btn"}),e("button",{onClick:_[1]||(_[1]=k=>y.value=!0),class:"open-filter schedul-btn"},p(t.$t("open-filter")),1)]),I(ae,{filters:G(m),class:"ProgrammList"},null,8,["filters"])]))}}),ke=L($e,[["__scopeId","data-v-abbdb3d8"]]),De={class:"table-content"},we={class:"timeline"},Ce={class:"timeline-column"},Ae={class:"timeline-header"},He={class:"stages"},Ie={class:"timeline-header"},Me={key:0},Ee={key:1},Pe={key:2},Ve=E({__name:"ScheduleTableItem",props:{date:String},setup(w){const S=w,{performances:h,acts:y,stages:u}=J(),v=l=>se(l,y),f=A(()=>h.value.filter(l=>{const i=T(l.start_time),d=T(S.date),r=i.getHours()<N&&i.getDate()===d.getDate()+1,b=i.getDate()===d.getDate()||r;return i.getHours()<N&&i.getDate()===d.getDate()?!1:b}).sort((l,i)=>{const d=T(l.start_time)??new Date(0),r=T(i.start_time)??new Date(0);return d.getTime()-r.getTime()})),t=A(()=>{const i=f.value.flatMap(s=>[T(s.start_time).getHours(),T(s.end_time).getHours()]).map(s=>s<N?s+24:s),d=Math.min(...i)-1,r=Math.max(...i)+1;return Array.from({length:r-d+1},(s,b)=>(d+b)%24)}),_=l=>{const i=T(l.start_time),d=T(l.end_time),r=t.value[0],s=t.value.length*60,b=(i.getHours()<r?i.getHours()+24:i.getHours())*60+i.getMinutes()-r*60,x=(d.getHours()<r?d.getHours()+24:d.getHours())*60+d.getMinutes()-r*60,B=b/s*100,z=(x-b)/s*100,O=1,a=t.value.length*60,g=O/a*100;return{top:`${B}%`,height:`calc(${z}% - ${g}%)`}},k=()=>{const l=t.value[0];return{height:`${((t.value[t.value.length-1]<l?t.value[t.value.length-1]+24:t.value[t.value.length-1])-l+1)*60}px`}},H=l=>{const i=t.value[0],d=t.value.length*60;return{top:((l<i?l+24:l)*60-i*60)/d*100+"%"}},q=l=>["concert","spezial","workshop"].includes(l)?l:"default";return(l,i)=>{const d=te("router-link");return o(),c("div",De,[e("div",we,[e("div",Ce,[e("div",Ae,p(l.$t("Time")),1),e("div",{class:"time-slots",style:P(k())},[(o(!0),c($,null,D(t.value,r=>(o(),c("div",{key:r,class:"time-slot",style:P(H(r))},p(r%24)+":00 ",5))),128))],4)])]),e("div",He,[(o(!0),c($,null,D(G(u),r=>(o(),c("div",{key:r.id,class:"stage"},[e("div",Ie,p(r.name),1),e("div",{class:"events",style:P(k())},[(o(!0),c($,null,D(t.value,s=>(o(),c("div",{key:s,class:"time-slot",style:P(H(s))},null,4))),128)),(o(!0),c($,null,D(f.value.filter(s=>s.stageID===r.id),s=>{var b;return o(),Q(d,{key:s.id,to:"/event/"+(((b=s["id-name"])==null?void 0:b.trim())||s.id),class:V(["event",q(s==null?void 0:s.type)]),style:P(_(s)),title:s.name||v(s.actsIDArr)||l.$t("Unknown")},{default:ee(()=>[e("strong",null,[s.name?(o(),c("div",Me,p(s.name),1)):s.actsIDArr.length?(o(),c("div",Ee,p(v(s.actsIDArr)),1)):(o(),c("div",Pe,p(l.$t("Unknown")),1))])]),_:2},1032,["to","class","style","title"])}),128))],4)]))),128))])])}}}),Qe=L(Ve,[["__scopeId","data-v-4cf34102"]]),Le={class:"timetable"},qe={class:"day-head"},Ne=E({__name:"ScheduleTable",setup(w){const{performances:S}=J(),h=A(()=>{const y=new Set(S.value.map(v=>T(v.start_time).toLocaleDateString("en-CA"))),u=new Set;return S.value.forEach(v=>{const f=T(v.start_time),t=f.getHours();if(t>=0&&t<N){const _=new Date(f);_.setDate(f.getDate()-1),u.add(_.toLocaleDateString("en-CA"))}}),Array.from(new Set([...y,...u])).sort()});return(y,u)=>(o(),c($,null,[I(W,{targetView:"list"}),e("div",Le,[(o(!0),c($,null,D(h.value,v=>(o(),c("div",{key:v,class:"day-table"},[e("h2",qe,p(v),1),I(Qe,{date:v},null,8,["date"])]))),128))])],64))}}),xe=L(Ne,[["__scopeId","data-v-85bb89a6"]]),Ge=E({__name:"ScheduleView",setup(w){const S=j();K();const h=A(()=>S.query.view??"list");return(y,u)=>(o(),c("div",null,[R(e("div",null,[I(ke)],512),[[U,h.value==="list"]]),R(e("div",null,[I(xe)],512),[[U,h.value==="table"]])]))}});export{Ge as default};
