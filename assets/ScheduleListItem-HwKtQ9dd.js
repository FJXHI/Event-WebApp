import{d as E,a as r,b as m,t as u,u as v,f as _,o,_ as S,N as J,O as W,c as $,r as K,w as M,z as b,E as O,F as N,D as C,P as X,K as V,g as T,L as Y,H as Z,G as ee,Q as te,J as se,p as ae}from"./index-DJxE-Fqm.js";import{u as ne}from"./useEventData-CLccO9Wt.js";import{T as oe,F as ie}from"./TagLabel-ClzWwkXI.js";import{N as re}from"./NoEntries-BQaiz-g7.js";const le={class:"group-head"},ce={class:"date-nav-container"},de={key:1,class:"nav-arrow nav-left"},ue=["id"],me={key:3,class:"nav-arrow nav-right"},ge=E({__name:"DateHead",props:{date:{},index:{},sortedDateList:{},scrollToDate:{type:Function}},setup(D){return(l,h)=>(o(),r("div",le,[m("div",ce,[l.sortedDateList[l.index-1]?(o(),r("button",{key:0,class:"nav-arrow nav-left",onClick:h[0]||(h[0]=y=>l.scrollToDate(l.sortedDateList[l.index-1]))}," < ")):(o(),r("div",de)),m("h2",{class:"head-date",id:l.date},u(v(_)(l.date,"Date Long")),9,ue),l.sortedDateList[l.index+1]?(o(),r("button",{key:2,class:"nav-arrow nav-right",onClick:h[1]||(h[1]=y=>l.scrollToDate(l.sortedDateList[l.index+1]))}," > ")):(o(),r("div",me))])]))}}),fe=S(ge,[["__scopeId","data-v-97f52d27"]]),_e={},he={class:"flow-btn"};function ve(D,l){return o(),r("button",he,[J(D.$slots,"default",{},void 0)])}const De=S(_e,[["render",ve],["__scopeId","data-v-e73f4560"]]),pe={class:"scroll-head schedule-list full-height"},Te={class:"scroll-y-area"},ye={class:"list-item-ul"},we={class:"list-item-info pad"},ke={class:"list-item-name"},Ie={key:0},Le={key:0},$e={key:1},be={key:2},Ne={class:"list-item-tags"},Ce=E({__name:"ScheduleListItem",props:{filters:{}},setup(D){const{t:l}=W();ae();const{scrollToDate:h}=Y(),y=$(()=>Object.keys(I.value).sort()),{performances:j,acts:p,stages:w}=ne(),z=D,H=e=>{const t=w.value.find(i=>i.id===e);return t?t.name:l("stageNotFound")},A=(e=[])=>ee(e,p),k=$(()=>{const e=z.filters;return j.value.filter(t=>{var i;if(e.stages.length&&!e.stages.includes(String(t.stageID)))return!1;if(e.stageTypes.length){const s=w.value.find(c=>c.id===t.stageID);if(!s||!e.stageTypes.includes(s.type))return!1}if(e.perforTypes.length&&!e.perforTypes.includes(t.type)||e.performanceTags.length&&(!t.tags||!t.tags.some(s=>e.performanceTags.includes(s)))||e.categories.length&&!t.actsIDArr.map(n=>p.value.find(d=>d.id===n)).filter(Boolean).flatMap(n=>n.tags.map(d=>d.name)).some(n=>e.categories.includes(n))||e.actTypes.length&&!t.actsIDArr.some(c=>{const n=p.value.find(g=>g.id===c);return((n==null?void 0:n["act-type"])||[]).some(g=>e.actTypes.includes(g))})||e.actIDs.length&&!e.actIDs.some(s=>t.actsIDArr.includes(Number(s)))||e.performanceIDs.length&&!e.performanceIDs.some(s=>t.id===Number(s)))return!1;if(e.searchQuery){const s=e.searchQuery.toLowerCase(),c=(t.name||"").toLowerCase().includes(s)||(t.description||"").toLowerCase().includes(s),n=t.actsIDArr.some(a=>{var F,P;const f=p.value.find(G=>G.id===a);return((F=f==null?void 0:f.name)==null?void 0:F.toLowerCase().includes(s))||((P=f==null?void 0:f.description)==null?void 0:P.toLowerCase().includes(s))}),d=w.value.find(a=>a.id===t.stageID),g=(i=d==null?void 0:d.name)==null?void 0:i.toLowerCase().includes(s);if(!c&&!n&&!g)return!1}return!0}).sort(Q)});function Q(e,t){return new Date(e.start_time).getTime()-new Date(t.start_time).getTime()}const I=$(()=>{const e={};for(const t of k.value){const i=_(t.start_time,"ISO"),s=_(t.start_time,"Time");e[i]||(e[i]={}),e[i][s]||(e[i][s]=[]),e[i][s].push(t)}return e}),B=K({});function R(e,t,i){i&&(B.value[`${e}_${t}`]=i)}function U(){q()}const L=K(null);L.value=new Date("2025-07-25T17:01:00");function q(){const e=L.value??new Date,t=k.value.filter(n=>new Date(n.start_time).getTime()>=e.getTime()).sort((n,d)=>new Date(n.start_time).getTime()-new Date(d.start_time).getTime());if(t.length===0){console.log("No upcoming performances found.");return}const i=t[0],s=_(i.start_time,"ISO"),c=_(i.start_time,"Time");X(()=>{const n=B.value[`${s}_${c}`];n?(console.log("Scroll to:",s,c),n.scrollIntoView({behavior:"smooth",block:"start"})):console.warn("Dont find Scroll-Target for:",s,c)})}function x(e){const t=L.value??new Date;return new Date(e.end_time).getTime()<t.getTime()}return(e,t)=>{const i=se("router-link");return o(),r("div",pe,[m("div",Te,[k.value.length>1?(o(),M(De,{key:0,class:"flow-btn",onClick:U},{default:O(()=>[V(u(e.$t("now")),1)]),_:1})):b("",!0),Object.keys(I.value).length===0?(o(),M(re,{key:1,type:"event"})):b("",!0),(o(!0),r(N,null,C(I.value,(s,c,n)=>(o(),r("div",{key:c,class:"date-group"},[T(fe,{date:c,index:n,sortedDateList:y.value,scrollToDate:v(h)},null,8,["date","index","sortedDateList","scrollToDate"]),(o(!0),r(N,null,C(s,(d,g)=>(o(),r("div",{key:g,class:"time-group"},[m("h3",{class:"group-head head-time pad",ref_for:!0,ref:a=>R(c,g,a)},u(g),513),m("ul",ye,[(o(!0),r(N,null,C(d,a=>{var f;return o(),r("li",{key:a.id,class:Z(["list-item-obj",{"performance-past":x(a)}])},[T(i,{to:`/event/${((f=a["id-name"])==null?void 0:f.trim())||a.id}`,class:"list-item-link"},{default:O(()=>[m("div",we,[m("strong",ke,[a.name?(o(),r("div",Ie,[V(u(a.name)+" ",1),a.actsIDArr.length?(o(),r("span",Le," ("+u(A(a.actsIDArr))+") ",1)):b("",!0)])):a.actsIDArr.length?(o(),r("div",$e,u(A(a.actsIDArr)),1)):(o(),r("div",be,u(e.$t("Unknown")),1))]),m("span",Ne,[m("span",null,u(H(a.stageID)),1),m("span",null,u(v(_)(a.start_time,"Date Long"))+", "+u(v(_)(a.start_time,"Time"))+" â€“ "+u(v(_)(a.end_time,"Time")),1),m("span",null,[T(oe,{name:v(te)(a.type),class:"tag-label-item"},null,8,["name"])])])])]),_:2},1032,["to"]),T(ie,{itemId:a.id.toString(),itemType:"event",class:"list-item-fav-btn"},null,8,["itemId"])],2)}),128))])]))),128))]))),128))])])}}}),Pe=S(Ce,[["__scopeId","data-v-5963a5fa"]]);export{fe as D,De as F,Pe as S};
