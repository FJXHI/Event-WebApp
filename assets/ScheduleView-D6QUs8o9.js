import{d as E,c as r,t as _,f as G,g as F,o,_ as V,r as M,b as I,a as e,F as D,h as w,u as j,i as P,j as X,k as L,w as B,e as A,l as Y,v as Z,m as ee,p as U,q as te,n as Q,s as se,x as ae}from"./index-BF-5QZq4.js";import{u as R,e as v,p as T,d as q}from"./useEventData-Dcdqaid4.js";import{S as ne}from"./ScheduleListItem-BGC2Ni8R.js";import{T as O}from"./tagLabel-jABmE6z4.js";import"./FavBtn-CoG8YCO1.js";const oe=E({__name:"SwitchView",props:{targetView:{}},setup(k){const h=k,f=G(),g=F(),i=()=>{f.replace({query:{...g.query,view:h.targetView}})};return(m,p)=>(o(),r("button",{onClick:i,class:"btn-view-chang"},_(m.$t("change-view")),1))}}),J=V(oe,[["__scopeId","data-v-4f880236"]]),le={class:"overlay"},re={class:"filter-modal"},ie={class:"filter-modal-header"},ce={class:"filter-modal-body"},ue={class:"filter-group"},de={class:"filter-button-group"},ve=["onClick"],me={class:"filter-group"},pe={class:"filter-button-group"},ge={class:"filter-group"},_e={class:"filter-button-group"},fe={class:"filter-group"},he={class:"filter-button-group"},ye={class:"filter-modal-footer"},Se=E({__name:"FilterMenu",props:{initialStages:{type:Array,default:()=>[]},initialCategories:{type:Array,default:()=>[]},initialTypes:{type:Array,default:()=>[]},initialPerformanceTags:{type:Array,default:()=>[]},initialSearchQuery:{type:String,default:""}},emits:["apply","close"],setup(k,{emit:h}){const f=h,{stages:g,acts:i,performances:m}=R(),p=k,t=M([...p.initialStages.map(Number)]),y=M([...p.initialCategories]),b=M([...p.initialTypes]),H=M([...p.initialPerformanceTags]),c=M(p.initialSearchQuery),l=I(()=>{const a=new Set;return i.value.forEach(S=>{var n;(n=S.tags)==null||n.forEach(C=>{C.visible&&a.add(C.name)})}),Array.from(a)}),u=I(()=>{const a=new Set;return m.value.forEach(S=>{S.type&&a.add(S.type)}),Array.from(a)}),d=I(()=>{const a=new Set;return m.value.forEach(S=>{var n;(n=S.tags)==null||n.forEach(C=>a.add(C))}),Array.from(a)}),s=(a,S)=>{const n=a.indexOf(S);n>=0?a.splice(n,1):a.push(S)},$=a=>s(t.value,a),x=a=>s(y.value,a),N=a=>s(b.value,a),z=a=>s(H.value,a),K=()=>{t.value=[],y.value=[],b.value=[],H.value=[],c.value=""},W=()=>{f("apply",{stages:t.value.map(String),categories:y.value,types:b.value,performanceTags:H.value,searchQuery:c.value.trim()}),f("close")};return(a,S)=>(o(),r("div",le,[e("div",re,[e("div",ie,[e("h2",null,_(a.$t("filter")),1),e("button",{onClick:S[0]||(S[0]=n=>a.$emit("close")),class:"filter-close-btn"},"×")]),e("div",ce,[e("button",{onClick:K,class:"filter-reset-btn"}," ↻ "+_(a.$t("reset-filter")),1),e("div",ue,[e("h3",null,_(a.$t("stages")),1),e("div",de,[(o(!0),r(D,null,w(j(g),n=>(o(),r("button",{key:n.id,onClick:C=>$(n.id),class:P({selected:t.value.includes(n.id)})},[S[1]||(S[1]=e("span",null,"📍",-1)),X(" "+_(n.name),1)],10,ve))),128))])]),e("div",me,[e("h3",null,_(a.$t("kategorien")),1),e("div",pe,[(o(!0),r(D,null,w(l.value,n=>(o(),L(O,{key:n,name:n,tag:"button",onClick:C=>x(n),class:P({selected:y.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",ge,[e("h3",null,_(a.$t("Performance-Types")),1),e("div",_e,[(o(!0),r(D,null,w(u.value,n=>(o(),L(O,{key:n,name:n,tag:"button",onClick:C=>N(n),class:P({selected:b.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",fe,[e("h3",null,_(a.$t("Performance-Tags")),1),e("div",he,[(o(!0),r(D,null,w(d.value,n=>(o(),L(O,{key:n,name:n,tag:"button",onClick:C=>z(n),class:P({selected:H.value.includes(n)})},null,8,["name","onClick","class"]))),128))])])]),e("div",ye,[e("button",{onClick:W,class:"filter-apply-btn"},_(a.$t("apply-filter")),1)])])]))}}),$e=V(Se,[["__scopeId","data-v-99d9e48d"]]),Te={class:"search-bar"},De={class:"search-inputline"},ke={class:"search-icon"},be=["placeholder"],we=E({__name:"SearchBar",emits:["apply"],setup(k,{emit:h}){const f=h,g=M(""),i=()=>{f("apply",g.value)};return(m,p)=>(o(),r("div",Te,[e("div",De,[e("div",ke,[A(Y,{class:"icon-size"})]),B(e("input",{type:"text","onUpdate:modelValue":p[0]||(p[0]=t=>g.value=t),onInput:i,placeholder:m.$t("search-placeholder")},null,40,be),[[Z,g.value]])])]))}}),Ce=V(we,[["__scopeId","data-v-e8aa6883"]]),Ie={class:"btn-header"},Ae=E({__name:"ScheduleList",setup(k){const h=F(),f=I(()=>h.query.search??"false"),g=M(!1),i=ee({stages:[],categories:[],types:[],performanceTags:[],searchQuery:""}),m=t=>{v.value.searchQuery=t,v.value.stages=[],v.value.categories=[],v.value.types=[],v.value.performanceTags=[],v.value.actIDs=[],v.value.performanceIDs=[]},p=t=>{v.value.stages=t.stages||[],v.value.categories=t.categories||[],v.value.types=t.types||[],v.value.performanceTags=t.performanceTags||[],v.value.searchQuery=t.searchQuery||"",v.value.actIDs=t.actIDs||[],v.value.performanceIDs=t.performanceIDs||[],i.stages=[...v.value.stages],i.categories=[...v.value.categories],i.types=[...v.value.types],i.performanceTags=[...v.value.performanceTags],i.searchQuery=v.value.searchQuery};return(t,y)=>(o(),r("div",null,[e("div",null,[B(A(Ce,{onApply:m},null,512),[[U,f.value==="true"]])]),e("div",Ie,[g.value?(o(),L($e,{key:0,"initial-stages":i.stages,"initial-categories":i.categories,"initial-types":i.types,"initial-performance-tags":i.performanceTags,"initial-search-query":i.searchQuery,onApply:p,onClose:y[0]||(y[0]=b=>g.value=!1)},null,8,["initial-stages","initial-categories","initial-types","initial-performance-tags","initial-search-query"])):te("",!0),A(J,{targetView:"table"}),e("button",{onClick:y[1]||(y[1]=b=>g.value=!0),class:"open-filter"},_(t.$t("open-filter")),1)]),A(ne,{filters:j(v),class:"ProgrammList"},null,8,["filters"])]))}}),He=V(Ae,[["__scopeId","data-v-f810c7f5"]]),Me={class:"table-content"},Ee={class:"timeline"},Ve={class:"timeline-column"},Qe={class:"timeline-header"},Le={class:"stages"},Pe={class:"timeline-header"},qe={key:0},Be={key:1},xe={key:2},Ne=E({__name:"ScheduleTableItem",props:{date:String},setup(k){const h=k,{performances:f,acts:g,stages:i}=R(),m=(c=[])=>c.map(l=>{var u;return((u=g.value.find(d=>d.id===l))==null?void 0:u.name)||"Unknown Artist"}).join(", "),p=I(()=>f.value.filter(c=>{const l=T(c.start_time),u=T(h.date),d=l.getHours()<q&&l.getDate()===u.getDate()+1,$=l.getDate()===u.getDate()||d;return l.getHours()<q&&l.getDate()===u.getDate()?!1:$}).sort((c,l)=>{const u=T(c.start_time)??new Date(0),d=T(l.start_time)??new Date(0);return u.getTime()-d.getTime()})),t=I(()=>{const l=p.value.flatMap(s=>[T(s.start_time).getHours(),T(s.end_time).getHours()]).map(s=>s<q?s+24:s),u=Math.min(...l)-1,d=Math.max(...l)+1;return Array.from({length:d-u+1},(s,$)=>(u+$)%24)}),y=c=>{const l=T(c.start_time),u=T(c.end_time),d=t.value[0],s=t.value.length*60,$=(l.getHours()<d?l.getHours()+24:l.getHours())*60+l.getMinutes()-d*60,x=(u.getHours()<d?u.getHours()+24:u.getHours())*60+u.getMinutes()-d*60,N=$/s*100+"%",z=(x-$)/s*100+"%";return{top:N,height:z}},b=()=>{const c=t.value[0];return{height:`${((t.value[t.value.length-1]<c?t.value[t.value.length-1]+24:t.value[t.value.length-1])-c+1)*60}px`}},H=c=>{const l=t.value[0],u=t.value.length*60;return{top:((c<l?c+24:c)*60-l*60)/u*100+"%"}};return(c,l)=>{const u=ae("router-link");return o(),r("div",Me,[e("div",Ee,[e("div",Ve,[e("div",Qe,_(c.$t("Time")),1),e("div",{class:"time-slots",style:Q(b())},[(o(!0),r(D,null,w(t.value,d=>(o(),r("div",{key:d,class:"time-slot",style:Q(H(d))},_(d%24)+":00 ",5))),128))],4)])]),e("div",Le,[(o(!0),r(D,null,w(j(i),d=>(o(),r("div",{key:d.id,class:"stage"},[e("div",Pe,_(d.name),1),e("div",{class:"events",style:Q(b())},[(o(!0),r(D,null,w(t.value,s=>(o(),r("div",{key:s,class:"time-slot",style:Q(H(s))},null,4))),128)),(o(!0),r(D,null,w(p.value.filter(s=>s.stageID===d.id),s=>{var $;return o(),L(u,{key:s.id,to:"/event/"+((($=s["id-name"])==null?void 0:$.trim())||s.id),class:"event",style:Q(y(s)),title:s.name||m(s.actsIDArr)||c.$t("Unknown")},{default:se(()=>[e("strong",null,[s.name?(o(),r("div",qe,_(s.name),1)):s.actsIDArr.length?(o(),r("div",Be,_(m(s.actsIDArr)),1)):(o(),r("div",xe,_(c.$t("Unknown")),1))])]),_:2},1032,["to","style","title"])}),128))],4)]))),128))])])}}}),ze=V(Ne,[["__scopeId","data-v-43ae1c7d"]]),Oe={class:"timetable"},Ue={class:"day-head"},Fe=E({__name:"ScheduleTable",setup(k){const{performances:h}=R(),f=I(()=>{const g=new Set(h.value.map(m=>T(m.start_time).toLocaleDateString("en-CA"))),i=new Set;return h.value.forEach(m=>{const p=T(m.start_time),t=p.getHours();if(t>=0&&t<q){const y=new Date(p);y.setDate(p.getDate()-1),i.add(y.toLocaleDateString("en-CA"))}}),Array.from(new Set([...g,...i])).sort()});return(g,i)=>(o(),r(D,null,[A(J,{targetView:"list"}),e("div",Oe,[(o(!0),r(D,null,w(f.value,m=>(o(),r("div",{key:m,class:"day-table"},[e("h2",Ue,_(m),1),A(ze,{date:m},null,8,["date"])]))),128))])],64))}}),je=V(Fe,[["__scopeId","data-v-71dec07e"]]),Xe=E({__name:"ScheduleView",setup(k){const h=F();G();const f=I(()=>h.query.view??"list");return(g,i)=>(o(),r("div",null,[B(e("div",null,[A(He)],512),[[U,f.value==="list"]]),B(e("div",null,[A(je)],512),[[U,f.value==="table"]])]))}});export{Xe as default};
