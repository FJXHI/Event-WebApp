import{d as j,a as r,b as m,t as u,u as p,f as _,o as i,_ as N,L as G,M as W,c as w,r as V,g as v,w as X,z as E,D as O,F as L,C as b,A as $,N as Y,J as K,E as Z,O as ee,H as te,p as se}from"./index-BuSadXxr.js";import{u as ae}from"./useEventData-BKzTjjr8.js";import{T as ne,F as oe}from"./TagLabel-ByfrNNI5.js";import{N as ie}from"./NoEntries-9sCrafwr.js";const re={class:"group-head"},le={class:"date-nav-container"},ce={key:1,class:"nav-arrow nav-left"},de=["id"],ue={key:3,class:"nav-arrow nav-right"},me=j({__name:"DateHead",props:{date:{},index:{},sortedDateList:{},scrollToDate:{type:Function}},setup(y){return(l,h)=>(i(),r("div",re,[m("div",le,[l.sortedDateList[l.index-1]?(i(),r("button",{key:0,class:"nav-arrow nav-left",onClick:h[0]||(h[0]=T=>l.scrollToDate(l.sortedDateList[l.index-1]))}," < ")):(i(),r("div",ce)),m("h2",{class:"head-date",id:l.date},u(p(_)(l.date,"Date Long")),9,de),l.sortedDateList[l.index+1]?(i(),r("button",{key:2,class:"nav-arrow nav-right",onClick:h[1]||(h[1]=T=>l.scrollToDate(l.sortedDateList[l.index+1]))}," > ")):(i(),r("div",ue))])]))}}),ge=N(me,[["__scopeId","data-v-97f52d27"]]),fe={},_e={class:"flow-btn"};function he(y,l){return i(),r("button",_e,[G(y.$slots,"default",{},void 0)])}const ve=N(fe,[["render",he],["__scopeId","data-v-8758dc6b"]]),pe={class:"scroll-head full-height"},ye={class:"scroll-y-area"},De={class:"list-item-ul"},Te={class:"list-item-info pad"},Ie={class:"list-item-name"},ke={key:0},we={key:0},Le={key:1},be={key:2},$e={class:"list-item-tags"},Ne=j({__name:"ScheduleListItem",props:{filters:{}},setup(y){const{t:l}=W(),h=se(),T=w(()=>Object.keys(k.value).sort());function z(e){h.replace({hash:`#${e}`});const t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})}const{performances:H,acts:D,stages:I}=ae(),P=y,R=e=>{const t=I.value.find(o=>o.id===e);return t?t.name:l("stageNotFound")},C=(e=[])=>Z(e,D),S=w(()=>{const e=P.filters;return H.value.filter(t=>{var o;if(e.stages.length&&!e.stages.includes(String(t.stageID)))return!1;if(e.stageTypes.length){const s=I.value.find(c=>c.id===t.stageID);if(!s||!e.stageTypes.includes(s.type))return!1}if(e.perforTypes.length&&!e.perforTypes.includes(t.type)||e.performanceTags.length&&(!t.tags||!t.tags.some(s=>e.performanceTags.includes(s)))||e.categories.length&&!t.actsIDArr.map(n=>D.value.find(d=>d.id===n)).filter(Boolean).flatMap(n=>n.tags.map(d=>d.name)).some(n=>e.categories.includes(n))||e.actTypes.length&&!t.actsIDArr.some(c=>{const n=D.value.find(g=>g.id===c);return((n==null?void 0:n["act-type"])||[]).some(g=>e.actTypes.includes(g))})||e.actIDs.length&&!e.actIDs.some(s=>t.actsIDArr.includes(Number(s)))||e.performanceIDs.length&&!e.performanceIDs.some(s=>t.id===Number(s)))return!1;if(e.searchQuery){const s=e.searchQuery.toLowerCase(),c=(t.name||"").toLowerCase().includes(s)||(t.description||"").toLowerCase().includes(s),n=t.actsIDArr.some(a=>{var F,M;const f=D.value.find(J=>J.id===a);return((F=f==null?void 0:f.name)==null?void 0:F.toLowerCase().includes(s))||((M=f==null?void 0:f.description)==null?void 0:M.toLowerCase().includes(s))}),d=I.value.find(a=>a.id===t.stageID),g=(o=d==null?void 0:d.name)==null?void 0:o.toLowerCase().includes(s);if(!c&&!n&&!g)return!1}return!0}).sort(Q)});function Q(e,t){return new Date(e.start_time).getTime()-new Date(t.start_time).getTime()}const k=w(()=>{const e={};for(const t of S.value){const o=_(t.start_time,"ISO"),s=_(t.start_time,"Time");e[o]||(e[o]={}),e[o][s]||(e[o][s]=[]),e[o][s].push(t)}return e}),A=V({});function U(e,t,o){o&&(A.value[`${e}_${t}`]=o)}function q(){x()}const B=V(null);B.value=new Date("2025-03-21T21:00:00");function x(){const e=B.value??new Date,t=S.value.filter(n=>$(n.start_time).getTime()>e.getTime()).sort((n,d)=>$(n.start_time).getTime()-$(d.start_time).getTime());if(t.length===0){console.log("No upcoming performances found.");return}const o=t[0],s=_(o.start_time,"ISO"),c=_(o.start_time,"Time");Y(()=>{const n=A.value[`${s}_${c}`];n?(console.log("Scroll to:",s,c),n.scrollIntoView({behavior:"smooth",block:"start"})):console.warn("Dont find Scroll-Target for:",s,c)})}return(e,t)=>{const o=te("router-link");return i(),r("div",pe,[m("div",ye,[v(ve,{class:"flow-btn",onClick:q},{default:O(()=>[K(u(e.$t("now")),1)]),_:1}),Object.keys(k.value).length===0?(i(),X(ie,{key:0,type:"event"})):E("",!0),(i(!0),r(L,null,b(k.value,(s,c,n)=>(i(),r("div",{key:c,class:"date-group"},[v(ge,{date:c,index:n,sortedDateList:T.value,scrollToDate:z},null,8,["date","index","sortedDateList"]),(i(!0),r(L,null,b(s,(d,g)=>(i(),r("div",{key:g,class:"time-group"},[m("h3",{class:"group-head head-time pad",ref_for:!0,ref:a=>U(c,g,a)},u(g),513),m("ul",De,[(i(!0),r(L,null,b(d,a=>{var f;return i(),r("li",{key:a.id,class:"list-item-obj"},[v(o,{to:`/event/${((f=a["id-name"])==null?void 0:f.trim())||a.id}`,class:"list-item-link"},{default:O(()=>[m("div",Te,[m("strong",Ie,[a.name?(i(),r("div",ke,[K(u(a.name)+" ",1),a.actsIDArr.length?(i(),r("span",we," ("+u(C(a.actsIDArr))+") ",1)):E("",!0)])):a.actsIDArr.length?(i(),r("div",Le,u(C(a.actsIDArr)),1)):(i(),r("div",be,u(e.$t("Unknown")),1))]),m("span",$e,[m("span",null,u(R(a.stageID)),1),m("span",null,u(p(_)(a.start_time,"Date Long"))+", "+u(p(_)(a.start_time,"Time"))+" â€“ "+u(p(_)(a.end_time,"Time")),1),m("span",null,[v(ne,{name:p(ee)(a.type),class:"tag-label-item"},null,8,["name"])])])])]),_:2},1032,["to"]),v(oe,{itemId:a.id.toString(),itemType:"event",class:"list-item-fav-btn"},null,8,["itemId"])])}),128))])]))),128))]))),128))])])}}}),Fe=N(Ne,[["__scopeId","data-v-4699e0cb"]]);export{ge as D,Fe as S};
