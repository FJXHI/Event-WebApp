import{d as E,a as i,t as _,k as K,l as j,o,_ as V,r as M,c as I,b as e,F as b,m as w,u as G,p as Q,q as X,s as L,w as q,e as A,v as Y,x as Z,y as ee,z as R,A as te,n as P,B as se,C as ae}from"./index-ByZbFJ75.js";import{e as p,p as T,d as B,g as ne}from"./config-CFcYo9TX.js";import{S as oe}from"./ScheduleListItem-CJwIIx7D.js";import{u as J}from"./useEventData-BXc6N1on.js";import{T as U}from"./tagLabel-CuO8aFNs.js";import"./FavBtn-BAbLzbI5.js";const le=E({__name:"SwitchView",props:{targetView:{}},setup(k){const y=k,f=K(),g=j(),c=()=>{f.replace({query:{...g.query,view:y.targetView}})};return(m,v)=>(o(),i("button",{onClick:c,class:"btn-view-chang"},_(m.$t("change-view")),1))}}),W=V(le,[["__scopeId","data-v-37e30bd6"]]),re={class:"overlay"},ie={class:"filter-modal"},ce={class:"filter-modal-header"},ue={class:"filter-modal-body"},de={class:"filter-group"},pe={class:"filter-button-group"},me=["onClick"],ve={class:"filter-group"},ge={class:"filter-button-group"},_e={class:"filter-group"},he={class:"filter-button-group"},fe={class:"filter-group"},ye={class:"filter-button-group"},$e={class:"filter-modal-footer"},Se=E({__name:"FilterMenu",props:{initialStages:{type:Array,default:()=>[]},initialCategories:{type:Array,default:()=>[]},initialTypes:{type:Array,default:()=>[]},initialPerformanceTags:{type:Array,default:()=>[]},initialSearchQuery:{type:String,default:""}},emits:["apply","close"],setup(k,{emit:y}){const f=y,{stages:g,acts:c,performances:m}=J(),v=k,t=M([...v.initialStages.map(Number)]),$=M([...v.initialCategories]),D=M([...v.initialTypes]),H=M([...v.initialPerformanceTags]),x=M(v.initialSearchQuery),l=I(()=>{const a=new Set;return c.value.forEach(h=>{var n;(n=h.tags)==null||n.forEach(C=>{C.visible&&a.add(C.name)})}),Array.from(a)}),u=I(()=>{const a=new Set;return m.value.forEach(h=>{h.type&&a.add(h.type)}),Array.from(a)}),d=I(()=>{const a=new Set;return m.value.forEach(h=>{var n;(n=h.tags)==null||n.forEach(C=>a.add(C))}),Array.from(a)}),r=(a,h)=>{const n=a.indexOf(h);n>=0?a.splice(n,1):a.push(h)},s=a=>r(t.value,a),S=a=>r($.value,a),N=a=>r(D.value,a),z=a=>r(H.value,a),O=()=>{t.value=[],$.value=[],D.value=[],H.value=[],x.value=""},F=()=>{f("apply",{stages:t.value.map(String),categories:$.value,types:D.value,performanceTags:H.value,searchQuery:x.value.trim()}),f("close")};return(a,h)=>(o(),i("div",re,[e("div",ie,[e("div",ce,[e("h2",null,_(a.$t("filter")),1),e("button",{onClick:h[0]||(h[0]=n=>a.$emit("close")),class:"filter-close-btn"},"×")]),e("div",ue,[e("button",{onClick:O,class:"filter-reset-btn"}," ↻ "+_(a.$t("reset-filter")),1),e("div",de,[e("h3",null,_(a.$t("stages")),1),e("div",pe,[(o(!0),i(b,null,w(G(g),n=>(o(),i("button",{key:n.id,onClick:C=>s(n.id),class:Q({selected:t.value.includes(n.id)})},[h[1]||(h[1]=e("span",null,"📍",-1)),X(" "+_(n.name),1)],10,me))),128))])]),e("div",ve,[e("h3",null,_(a.$t("kategorien")),1),e("div",ge,[(o(!0),i(b,null,w(l.value,n=>(o(),L(U,{key:n,name:n,tag:"button",onClick:C=>S(n),class:Q({selected:$.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",_e,[e("h3",null,_(a.$t("Performance-Types")),1),e("div",he,[(o(!0),i(b,null,w(u.value,n=>(o(),L(U,{key:n,name:n,tag:"button",onClick:C=>N(n),class:Q({selected:D.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",fe,[e("h3",null,_(a.$t("Performance-Tags")),1),e("div",ye,[(o(!0),i(b,null,w(d.value,n=>(o(),L(U,{key:n,name:n,tag:"button",onClick:C=>z(n),class:Q({selected:H.value.includes(n)})},null,8,["name","onClick","class"]))),128))])])]),e("div",$e,[e("button",{onClick:F,class:"filter-apply-btn"},_(a.$t("apply-filter")),1)])])]))}}),Te=V(Se,[["__scopeId","data-v-99d9e48d"]]),be={class:"search-bar"},ke={class:"search-inputline"},De={class:"search-icon"},we=["placeholder"],Ce=E({__name:"SearchBar",emits:["apply"],setup(k,{emit:y}){const f=y,g=M(""),c=()=>{f("apply",g.value)};return(m,v)=>(o(),i("div",be,[e("div",ke,[e("div",De,[A(Y,{class:"icon-size"})]),q(e("input",{type:"text","onUpdate:modelValue":v[0]||(v[0]=t=>g.value=t),onInput:c,placeholder:m.$t("search-placeholder")},null,40,we),[[Z,g.value]])])]))}}),Ie=V(Ce,[["__scopeId","data-v-e8aa6883"]]),Ae={class:"btn-header"},He=E({__name:"ScheduleList",setup(k){const y=j(),f=I(()=>y.query.search??"false"),g=M(!1),c=ee({stages:[],categories:[],types:[],performanceTags:[],searchQuery:""}),m=t=>{p.value.searchQuery=t,p.value.stages=[],p.value.categories=[],p.value.types=[],p.value.performanceTags=[],p.value.actIDs=[],p.value.performanceIDs=[]},v=t=>{p.value.stages=t.stages||[],p.value.categories=t.categories||[],p.value.types=t.types||[],p.value.performanceTags=t.performanceTags||[],p.value.searchQuery=t.searchQuery||"",p.value.actIDs=t.actIDs||[],p.value.performanceIDs=t.performanceIDs||[],c.stages=[...p.value.stages],c.categories=[...p.value.categories],c.types=[...p.value.types],c.performanceTags=[...p.value.performanceTags],c.searchQuery=p.value.searchQuery};return(t,$)=>(o(),i("div",null,[e("div",null,[q(A(Ie,{onApply:m},null,512),[[R,f.value==="true"]])]),e("div",Ae,[g.value?(o(),L(Te,{key:0,"initial-stages":c.stages,"initial-categories":c.categories,"initial-types":c.types,"initial-performance-tags":c.performanceTags,"initial-search-query":c.searchQuery,onApply:v,onClose:$[0]||($[0]=D=>g.value=!1)},null,8,["initial-stages","initial-categories","initial-types","initial-performance-tags","initial-search-query"])):te("",!0),A(W,{targetView:"table",class:"schedul-btn"}),e("button",{onClick:$[1]||($[1]=D=>g.value=!0),class:"open-filter schedul-btn"},_(t.$t("open-filter")),1)]),A(oe,{filters:G(p),class:"ProgrammList"},null,8,["filters"])]))}}),Me=V(He,[["__scopeId","data-v-3797a104"]]),Ee={class:"table-content"},Ve={class:"timeline"},Pe={class:"timeline-column"},Qe={class:"timeline-header"},Le={class:"stages"},xe={class:"timeline-header"},Be={key:0},qe={key:1},Ne={key:2},ze=E({__name:"ScheduleTableItem",props:{date:String},setup(k){const y=k,{performances:f,acts:g,stages:c}=J(),m=l=>ne(l,g),v=I(()=>f.value.filter(l=>{const u=T(l.start_time),d=T(y.date),r=u.getHours()<B&&u.getDate()===d.getDate()+1,S=u.getDate()===d.getDate()||r;return u.getHours()<B&&u.getDate()===d.getDate()?!1:S}).sort((l,u)=>{const d=T(l.start_time)??new Date(0),r=T(u.start_time)??new Date(0);return d.getTime()-r.getTime()})),t=I(()=>{const u=v.value.flatMap(s=>[T(s.start_time).getHours(),T(s.end_time).getHours()]).map(s=>s<B?s+24:s),d=Math.min(...u)-1,r=Math.max(...u)+1;return Array.from({length:r-d+1},(s,S)=>(d+S)%24)}),$=l=>{const u=T(l.start_time),d=T(l.end_time),r=t.value[0],s=t.value.length*60,S=(u.getHours()<r?u.getHours()+24:u.getHours())*60+u.getMinutes()-r*60,N=(d.getHours()<r?d.getHours()+24:d.getHours())*60+d.getMinutes()-r*60,z=S/s*100,O=(N-S)/s*100,F=1,a=t.value.length*60,h=F/a*100;return{top:`${z}%`,height:`calc(${O}% - ${h}%)`}},D=()=>{const l=t.value[0];return{height:`${((t.value[t.value.length-1]<l?t.value[t.value.length-1]+24:t.value[t.value.length-1])-l+1)*60}px`}},H=l=>{const u=t.value[0],d=t.value.length*60;return{top:((l<u?l+24:l)*60-u*60)/d*100+"%"}},x=l=>["concert","spezial","workshop"].includes(l)?l:"default";return(l,u)=>{const d=ae("router-link");return o(),i("div",Ee,[e("div",Ve,[e("div",Pe,[e("div",Qe,_(l.$t("Time")),1),e("div",{class:"time-slots",style:P(D())},[(o(!0),i(b,null,w(t.value,r=>(o(),i("div",{key:r,class:"time-slot",style:P(H(r))},_(r%24)+":00 ",5))),128))],4)])]),e("div",Le,[(o(!0),i(b,null,w(G(c),r=>(o(),i("div",{key:r.id,class:"stage"},[e("div",xe,_(r.name),1),e("div",{class:"events",style:P(D())},[(o(!0),i(b,null,w(t.value,s=>(o(),i("div",{key:s,class:"time-slot",style:P(H(s))},null,4))),128)),(o(!0),i(b,null,w(v.value.filter(s=>s.stageID===r.id),s=>{var S;return o(),L(d,{key:s.id,to:"/event/"+(((S=s["id-name"])==null?void 0:S.trim())||s.id),class:Q(["event",x(s==null?void 0:s.type)]),style:P($(s)),title:s.name||m(s.actsIDArr)||l.$t("Unknown")},{default:se(()=>[e("strong",null,[s.name?(o(),i("div",Be,_(s.name),1)):s.actsIDArr.length?(o(),i("div",qe,_(m(s.actsIDArr)),1)):(o(),i("div",Ne,_(l.$t("Unknown")),1))])]),_:2},1032,["to","class","style","title"])}),128))],4)]))),128))])])}}}),Oe=V(ze,[["__scopeId","data-v-4cf34102"]]),Fe={class:"timetable"},Ue={class:"day-head"},Re=E({__name:"ScheduleTable",setup(k){const{performances:y}=J(),f=I(()=>{const g=new Set(y.value.map(m=>T(m.start_time).toLocaleDateString("en-CA"))),c=new Set;return y.value.forEach(m=>{const v=T(m.start_time),t=v.getHours();if(t>=0&&t<B){const $=new Date(v);$.setDate(v.getDate()-1),c.add($.toLocaleDateString("en-CA"))}}),Array.from(new Set([...g,...c])).sort()});return(g,c)=>(o(),i(b,null,[A(W,{targetView:"list"}),e("div",Fe,[(o(!0),i(b,null,w(f.value,m=>(o(),i("div",{key:m,class:"day-table"},[e("h2",Ue,_(m),1),A(Oe,{date:m},null,8,["date"])]))),128))])],64))}}),je=V(Re,[["__scopeId","data-v-85bb89a6"]]),Ze=E({__name:"ScheduleView",setup(k){const y=j();K();const f=I(()=>y.query.view??"list");return(g,c)=>(o(),i("div",null,[q(e("div",null,[A(Me)],512),[[R,f.value==="list"]]),q(e("div",null,[A(je)],512),[[R,f.value==="table"]])]))}});export{Ze as default};
