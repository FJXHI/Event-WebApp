import{d as O,a as l,b as u,t as f,u as k,f as _,o as r,_ as B,N as J,O as W,c as S,r as M,w as C,z as P,E as K,F as y,D as w,P as X,K as Y,g as A,L as Z,H as ee,G as te,J as se,Q as ae,p as ne}from"./index-BtGVOPzC.js";import{u as oe}from"./useEventData-Bz0AY5MH.js";import{T as ie,F as re}from"./TagLabel-iyCIfeOl.js";import{N as le}from"./NoEntries-CkPkM5cZ.js";const ce={class:"group-head"},de={class:"date-nav-container"},ue={key:1,class:"nav-arrow nav-left"},me=["id"],ge={key:3,class:"nav-arrow nav-right"},fe=O({__name:"DateHead",props:{date:{},index:{},sortedDateList:{},scrollToDate:{type:Function}},setup(p){return(c,v)=>(r(),l("div",ce,[u("div",de,[c.sortedDateList[c.index-1]?(r(),l("button",{key:0,class:"nav-arrow nav-left",onClick:v[0]||(v[0]=I=>c.scrollToDate(c.sortedDateList[c.index-1]))}," < ")):(r(),l("div",ue)),u("h2",{class:"head-date",id:c.date},f(k(_)(c.date,"Date Long")),9,me),c.sortedDateList[c.index+1]?(r(),l("button",{key:2,class:"nav-arrow nav-right",onClick:v[1]||(v[1]=I=>c.scrollToDate(c.sortedDateList[c.index+1]))}," > ")):(r(),l("div",ge))])]))}}),_e=B(fe,[["__scopeId","data-v-97f52d27"]]),ve={},he={class:"flow-btn"};function pe(p,c){return r(),l("button",he,[J(p.$slots,"default",{},void 0)])}const Te=B(ve,[["render",pe],["__scopeId","data-v-e73f4560"]]),De={class:"scroll-head schedule-list full-height"},ye={class:"scroll-y-area"},we={class:"list-item-ul"},ke={class:"list-item-info pad"},Ie={class:"list-item-name"},Le={key:0},$e={key:1},be={key:2},Ne={class:"list-item-tags"},Se=O({__name:"ScheduleListItem",props:{filters:{}},setup(p){const{t:c}=W();ne();const{scrollToDate:v}=Z(),I=S(()=>Object.keys(b.value).sort());function V(e){const t=ae(e.type),n=e.actsIDArr.map(o=>h.value.find(a=>a.id===o)).filter(Boolean).flatMap(o=>((o==null?void 0:o.tags)||[]).filter(a=>a.visible).map(a=>a.name)),s=[t,...n];return[...new Set(s)]}const{performances:E,acts:h,stages:L}=oe(),j=p,z=e=>{const t=L.value.find(n=>n.id===e);return t?t.name:c("stageNotFound")},H=(e=[])=>te(e,h),$=S(()=>{const e=j.filters;return E.value.filter(t=>{var n;if(e.stages.length&&!e.stages.includes(String(t.stageID)))return!1;if(e.stageTypes.length){const s=L.value.find(o=>o.id===t.stageID);if(!s||!e.stageTypes.includes(s.type))return!1}if(e.perforTypes.length&&!e.perforTypes.includes(t.type)||e.performanceTags.length&&(!t.tags||!t.tags.some(s=>e.performanceTags.includes(s)))||e.categories.length&&!t.actsIDArr.map(a=>h.value.find(d=>d.id===a)).filter(Boolean).flatMap(a=>a.tags.map(d=>d.name)).some(a=>e.categories.includes(a))||e.actTypes.length&&!t.actsIDArr.some(o=>{const a=h.value.find(m=>m.id===o);return((a==null?void 0:a["act-type"])||[]).some(m=>e.actTypes.includes(m))})||e.actIDs.length&&!e.actIDs.some(s=>t.actsIDArr.includes(Number(s)))||e.performanceIDs.length&&!e.performanceIDs.some(s=>t.id===Number(s)))return!1;if(e.searchQuery){const s=e.searchQuery.toLowerCase(),o=(t.name||"").toLowerCase().includes(s)||(t.description||"").toLowerCase().includes(s),a=t.actsIDArr.some(i=>{var T,D;const g=h.value.find(G=>G.id===i);return((T=g==null?void 0:g.name)==null?void 0:T.toLowerCase().includes(s))||((D=g==null?void 0:g.description)==null?void 0:D.toLowerCase().includes(s))}),d=L.value.find(i=>i.id===t.stageID),m=(n=d==null?void 0:d.name)==null?void 0:n.toLowerCase().includes(s);if(!o&&!a&&!m)return!1}return!0}).sort(Q)});function Q(e,t){return new Date(e.start_time).getTime()-new Date(t.start_time).getTime()}const b=S(()=>{const e={};for(const t of $.value){const n=_(t.start_time,"ISO"),s=_(t.start_time,"Time");e[n]||(e[n]={}),e[n][s]||(e[n][s]=[]),e[n][s].push(t)}return e}),F=M({});function R(e,t,n){n&&(F.value[`${e}_${t}`]=n)}function U(){q()}const N=M(null);N.value=new Date("2025-07-25T17:01:00");function q(){const e=N.value??new Date,t=$.value.filter(a=>new Date(a.start_time).getTime()>=e.getTime()).sort((a,d)=>new Date(a.start_time).getTime()-new Date(d.start_time).getTime());if(t.length===0){console.log("No upcoming performances found.");return}const n=t[0],s=_(n.start_time,"ISO"),o=_(n.start_time,"Time");X(()=>{const a=F.value[`${s}_${o}`];a?(console.log("Scroll to:",s,o),a.scrollIntoView({behavior:"smooth",block:"start"})):console.warn("Dont find Scroll-Target for:",s,o)})}function x(e){const t=N.value??new Date;return new Date(e.end_time).getTime()<t.getTime()}return(e,t)=>{const n=se("router-link");return r(),l("div",De,[u("div",ye,[$.value.length>1?(r(),C(Te,{key:0,class:"flow-btn",onClick:U},{default:K(()=>[Y(f(e.$t("now")),1)]),_:1})):P("",!0),Object.keys(b.value).length===0?(r(),C(le,{key:1,type:"event"})):P("",!0),(r(!0),l(y,null,w(b.value,(s,o,a)=>(r(),l("div",{key:o,class:"date-group"},[A(_e,{date:o,index:a,sortedDateList:I.value,scrollToDate:k(v)},null,8,["date","index","sortedDateList","scrollToDate"]),(r(!0),l(y,null,w(s,(d,m)=>(r(),l("div",{key:m,class:"time-group"},[u("h3",{class:"group-head head-time pad",ref_for:!0,ref:i=>R(o,m,i)},f(m),513),u("ul",we,[(r(!0),l(y,null,w(d,i=>{var g;return r(),l("li",{key:i.id,class:ee(["list-item-obj",{"performance-past":x(i)}])},[A(n,{to:`/event/${((g=i["id-name"])==null?void 0:g.trim())||i.id}`,class:"list-item-link"},{default:K(()=>[u("div",ke,[u("strong",Ie,[i.name?(r(),l("div",Le,f(i.name),1)):i.actsIDArr.length?(r(),l("div",$e,f(H(i.actsIDArr)),1)):(r(),l("div",be,f(e.$t("Unknown")),1))]),u("span",Ne,[u("span",null,f(z(i.stageID))+" "+f(k(_)(i.start_time,"Time"))+" â€“ "+f(k(_)(i.end_time,"Time")),1),u("span",null,[(r(!0),l(y,null,w(V(i),(T,D)=>(r(),C(ie,{key:`tag-${i.id}-${D}`,name:T,class:"tag-label-item"},null,8,["name"]))),128))])])])]),_:2},1032,["to"]),A(re,{itemId:i.id.toString(),itemType:"event",class:"list-item-fav-btn"},null,8,["itemId"])],2)}),128))])]))),128))]))),128))])])}}}),Me=B(Se,[["__scopeId","data-v-3eb01622"]]);export{_e as D,Te as F,Me as S};
