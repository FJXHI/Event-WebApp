import{d as P,a as i,t as f,m as J,p as j,o as a,_ as Q,r as M,c as D,b as e,F as C,q as I,u as K,s as q,v as X,w as L,x as Y,y as d,g as E,z as U,A as G,B as Z,C as w,D as B,n as V,E as ee,G as te,H as se,f as ae}from"./index-B9ReRuP_.js";import{S as ne}from"./ScheduleListItem-DQL3a2Yk.js";import{u as N}from"./useEventData-B966vkfO.js";import{T as R}from"./tagLabel-DllIO0k8.js";import{S as oe}from"./SearchBar-CFgHlcB5.js";import"./FavBtn-DyDcf-I2.js";const re=P({__name:"SwitchView",props:{targetView:{}},setup(A){const y=A,h=J(),T=j(),S=()=>{h.replace({query:{...T.query,view:y.targetView}})};return(g,l)=>(a(),i("button",{onClick:S,class:"btn-view-chang"},f(g.$t("change-view")),1))}}),W=Q(re,[["__scopeId","data-v-37e30bd6"]]),le={class:"overlay"},ie={class:"filter-modal"},ce={class:"filter-modal-header"},ue={class:"filter-modal-body"},de={class:"filter-group"},ve={class:"filter-button-group"},me=["onClick"],ge={class:"filter-group"},pe={class:"filter-button-group"},fe={class:"filter-group"},_e={class:"filter-button-group"},he={class:"filter-group"},ye={class:"filter-button-group"},$e={class:"filter-modal-footer"},Se=P({__name:"FilterMenu",props:{initialStages:{type:Array,default:()=>[]},initialCategories:{type:Array,default:()=>[]},initialTypes:{type:Array,default:()=>[]},initialPerformanceTags:{type:Array,default:()=>[]},initialSearchQuery:{type:String,default:""}},emits:["apply","close"],setup(A,{emit:y}){const h=y,{stages:T,acts:S,performances:g}=N(),l=A,o=M([...l.initialStages.map(Number)]),p=M([...l.initialCategories]),$=M([...l.initialTypes]),k=M([...l.initialPerformanceTags]),v=M(l.initialSearchQuery),s=D(()=>{const n=new Set;return S.value.forEach(_=>{var r;(r=_.tags)==null||r.forEach(H=>{H.visible&&n.add(H.name)})}),Array.from(n)}),c=D(()=>{const n=new Set;return g.value.forEach(_=>{_.type&&n.add(_.type)}),Array.from(n)}),m=D(()=>{const n=new Set;return g.value.forEach(_=>{var r;(r=_.tags)==null||r.forEach(H=>n.add(H))}),Array.from(n)}),u=(n,_)=>{const r=n.indexOf(_);r>=0?n.splice(r,1):n.push(_)},t=n=>u(o.value,n),b=n=>u(p.value,n),z=n=>u($.value,n),O=n=>u(k.value,n),x=()=>{o.value=[],p.value=[],$.value=[],k.value=[],v.value=""},F=()=>{h("apply",{stages:o.value.map(String),categories:p.value,types:$.value,performanceTags:k.value,searchQuery:v.value.trim()}),h("close")};return(n,_)=>(a(),i("div",le,[e("div",ie,[e("div",ce,[e("h2",null,f(n.$t("filter")),1),e("button",{onClick:_[0]||(_[0]=r=>n.$emit("close")),class:"filter-close-btn"},"×")]),e("div",ue,[e("button",{onClick:x,class:"filter-reset-btn"}," ↻ "+f(n.$t("reset-filter")),1),e("div",de,[e("h3",null,f(n.$t("stages")),1),e("div",ve,[(a(!0),i(C,null,I(K(T),r=>(a(),i("button",{key:r.id,onClick:H=>t(r.id),class:q({selected:o.value.includes(r.id)})},[_[1]||(_[1]=e("span",null,"📍",-1)),X(" "+f(r.name),1)],10,me))),128))])]),e("div",ge,[e("h3",null,f(n.$t("kategorien")),1),e("div",pe,[(a(!0),i(C,null,I(s.value,r=>(a(),L(R,{key:r,name:r,tag:"button",onClick:H=>b(r),class:q({selected:p.value.includes(r)})},null,8,["name","onClick","class"]))),128))])]),e("div",fe,[e("h3",null,f(n.$t("Performance-Types")),1),e("div",_e,[(a(!0),i(C,null,I(c.value,r=>(a(),L(R,{key:r,name:r,tag:"button",onClick:H=>z(r),class:q({selected:$.value.includes(r)})},null,8,["name","onClick","class"]))),128))])]),e("div",he,[e("h3",null,f(n.$t("Performance-Tags")),1),e("div",ye,[(a(!0),i(C,null,I(m.value,r=>(a(),L(R,{key:r,name:r,tag:"button",onClick:H=>O(r),class:q({selected:k.value.includes(r)})},null,8,["name","onClick","class"]))),128))])])]),e("div",$e,[e("button",{onClick:F,class:"filter-apply-btn"},f(n.$t("apply-filter")),1)])])]))}}),ke=Q(Se,[["__scopeId","data-v-99d9e48d"]]),Te={class:"btn-header"},be=P({__name:"ScheduleList",setup(A){const{performances:y}=N(),h=j(),T=D(()=>h.query.search??"false"),S=D(()=>h.query.fav==="true"),g=M(!1),l=Y({stages:[],categories:[],types:[],performanceTags:[],searchQuery:""}),o=v=>{d.value.searchQuery=v,d.value.stages=[],d.value.categories=[],d.value.types=[],d.value.performanceTags=[],d.value.actIDs=[],d.value.performanceIDs=[]},p=v=>{d.value.stages=v.stages||[],d.value.categories=v.categories||[],d.value.types=v.types||[],d.value.performanceTags=v.performanceTags||[],d.value.searchQuery=v.searchQuery||"",d.value.actIDs=v.actIDs||[],d.value.performanceIDs=v.performanceIDs||[],l.stages=[...d.value.stages],l.categories=[...d.value.categories],l.types=[...d.value.types],l.performanceTags=[...d.value.performanceTags],l.searchQuery=d.value.searchQuery},$=D(()=>S.value?{...d.value,performanceIDs:k.value.map(v=>String(v.id))}:d.value),k=D(()=>{const v=JSON.parse(localStorage.getItem("event")||"[]");return!y.value||y.value.length===0?(console.warn("Performances data not available yet!"),[]):y.value.filter(s=>v.includes(s.id.toString()))});return(v,s)=>(a(),i("div",null,[e("div",null,[U(E(oe,{onApply:o},null,512),[[G,T.value==="true"]])]),e("div",Te,[g.value?(a(),L(ke,{key:0,"initial-stages":l.stages,"initial-categories":l.categories,"initial-types":l.types,"initial-performance-tags":l.performanceTags,"initial-search-query":l.searchQuery,onApply:p,onClose:s[0]||(s[0]=c=>g.value=!1)},null,8,["initial-stages","initial-categories","initial-types","initial-performance-tags","initial-search-query"])):Z("",!0),E(W,{targetView:"table",class:"schedul-btn"}),e("button",{onClick:s[1]||(s[1]=c=>g.value=!0),class:"open-filter schedul-btn"},f(v.$t("open-filter")),1)]),E(ne,{filters:$.value,class:"ProgrammList"},null,8,["filters"])]))}}),De=Q(be,[["__scopeId","data-v-f21c754a"]]),we={class:"table-content"},Ce={class:"timeline"},Ie={class:"timeline-column"},Ae={class:"timeline-header"},He={class:"stages"},Ee={class:"timeline-header"},Me={key:0},Pe={key:1},Ve={key:2},qe=P({__name:"ScheduleTableItem",props:{date:String},setup(A){const y=A,{performances:h,acts:T,stages:S}=N(),g=s=>te(s,T),l=D(()=>h.value.filter(s=>{const c=w(s.start_time),m=w(y.date),u=c.getHours()<B&&c.getDate()===m.getDate()+1,b=c.getDate()===m.getDate()||u;return c.getHours()<B&&c.getDate()===m.getDate()?!1:b}).sort((s,c)=>{const m=w(s.start_time)??new Date(0),u=w(c.start_time)??new Date(0);return m.getTime()-u.getTime()})),o=D(()=>{const c=l.value.flatMap(t=>[w(t.start_time).getHours(),w(t.end_time).getHours()]).map(t=>t<B?t+24:t),m=Math.min(...c)-1,u=Math.max(...c)+1;return Array.from({length:u-m+1},(t,b)=>(m+b)%24)}),p=s=>{const c=w(s.start_time),m=w(s.end_time),u=o.value[0],t=o.value.length*60,b=(c.getHours()<u?c.getHours()+24:c.getHours())*60+c.getMinutes()-u*60,z=(m.getHours()<u?m.getHours()+24:m.getHours())*60+m.getMinutes()-u*60,O=b/t*100,x=(z-b)/t*100,F=1,n=o.value.length*60,_=F/n*100;return{top:`${O}%`,height:`calc(${x}% - ${_}%)`}},$=()=>{const s=o.value[0];return{height:`${((o.value[o.value.length-1]<s?o.value[o.value.length-1]+24:o.value[o.value.length-1])-s+1)*60}px`}},k=s=>{const c=o.value[0],m=o.value.length*60;return{top:((s<c?s+24:s)*60-c*60)/m*100+"%"}},v=s=>["concert","spezial","workshop"].includes(s)?s:"default";return(s,c)=>{const m=se("router-link");return a(),i("div",we,[e("div",Ce,[e("div",Ie,[e("div",Ae,f(s.$t("Time")),1),e("div",{class:"time-slots",style:V($())},[(a(!0),i(C,null,I(o.value,u=>(a(),i("div",{key:u,class:"time-slot",style:V(k(u))},f(u%24)+":00 ",5))),128))],4)])]),e("div",He,[(a(!0),i(C,null,I(K(S),u=>(a(),i("div",{key:u.id,class:"stage"},[e("div",Ee,f(u.name),1),e("div",{class:"events",style:V($())},[(a(!0),i(C,null,I(o.value,t=>(a(),i("div",{key:t,class:"time-slot",style:V(k(t))},null,4))),128)),(a(!0),i(C,null,I(l.value.filter(t=>t.stageID===u.id),t=>{var b;return a(),L(m,{key:t.id,to:"/event/"+(((b=t["id-name"])==null?void 0:b.trim())||t.id),class:q(["event",v(t==null?void 0:t.type)]),style:V(p(t)),title:t.name||g(t.actsIDArr)||s.$t("Unknown")},{default:ee(()=>[e("strong",null,[t.name?(a(),i("div",Me,f(t.name),1)):t.actsIDArr.length?(a(),i("div",Pe,f(g(t.actsIDArr)),1)):(a(),i("div",Ve,f(s.$t("Unknown")),1))])]),_:2},1032,["to","class","style","title"])}),128))],4)]))),128))])])}}}),Le=Q(qe,[["__scopeId","data-v-96ac454f"]]),Qe={class:"timetable"},Be={class:"group-head"},Ne={class:"date-nav-container"},ze=["onClick"],Oe={key:1,class:"nav-arrow nav-left"},xe=["id"],Fe=["onClick"],Re={key:3,class:"nav-arrow nav-right"},Ue=P({__name:"ScheduleTable",setup(A){const y=J();function h(g){y.replace({hash:`#${g}`,query:{...y.currentRoute.value.query}});const l=document.getElementById(g);l&&l.scrollIntoView({behavior:"smooth"})}const{performances:T}=N(),S=D(()=>{const g=new Set(T.value.map(o=>w(o.start_time).toLocaleDateString("en-CA"))),l=new Set;return T.value.forEach(o=>{const p=w(o.start_time),$=p.getHours();if($>=0&&$<B){const k=new Date(p);k.setDate(p.getDate()-1),l.add(k.toLocaleDateString("en-CA"))}}),Array.from(new Set([...g,...l])).sort()});return(g,l)=>(a(),i(C,null,[E(W,{targetView:"list"}),e("div",Qe,[(a(!0),i(C,null,I(S.value,(o,p)=>(a(),i("div",{key:o,class:"day-table"},[e("div",Be,[e("div",Ne,[p>0?(a(),i("button",{key:0,class:"nav-arrow nav-left",onClick:$=>h(S.value[p-1])}," < ",8,ze)):(a(),i("div",Oe)),e("h2",{class:"head-date",id:o},f(K(ae)(o,"Date Long")),9,xe),p<S.value.length-1?(a(),i("button",{key:2,class:"nav-arrow nav-right",onClick:$=>h(S.value[p+1])}," > ",8,Fe)):(a(),i("div",Re))])]),E(Le,{date:o},null,8,["date"])]))),128))])],64))}}),Ge=Q(Ue,[["__scopeId","data-v-708cb6ff"]]),Ze=P({__name:"ScheduleView",setup(A){const y=j();J();const h=D(()=>y.query.view??"list");return(T,S)=>(a(),i("div",null,[U(e("div",null,[E(De)],512),[[G,h.value==="list"]]),U(e("div",null,[E(Ge)],512),[[G,h.value==="table"]])]))}});export{Ze as default};
