import{d as M,a as l,t as T,p as L,q as B,o,_ as E,c as D,r as U,s as J,v as s,b as v,g as $,w as V,x as q,y as P,z as K,A as h,B as A,n as H,F as I,C,D as W,E as j,G as X,H as Y,u as Z,f as ee}from"./index-C__xxzqB.js";import{S as te}from"./ScheduleListItem-snD2vgy7.js";import{S as se,F as ae}from"./SearchBar-QIW37Vyk.js";import{u as x}from"./useEventData-jweThlje.js";import"./TagLabel-CiNlt0xw.js";const re=M({__name:"SwitchView",props:{targetView:{}},setup(b){const d=b,g=L(),_=B(),y=()=>{g.replace({query:{..._.query,view:d.targetView}})};return(p,a)=>(o(),l("button",{onClick:y,class:"btn-view-chang"},T(p.$t("change-view")),1))}}),F=E(re,[["__scopeId","data-v-37e30bd6"]]),ne={class:"btn-header"},oe=M({__name:"ScheduleList",setup(b){const{performances:d}=x(),g=B(),_=D(()=>g.query.search??"false"),y=D(()=>g.query.fav==="true"),p=U(!1),a=J({stages:[],stageTypes:[],categories:[],actTypes:[],perforTypes:[],performanceTags:[],searchQuery:""}),m=i=>{s.value.searchQuery=i,s.value.stages=[],s.value.stageTypes=[],s.value.categories=[],s.value.actTypes=[],s.value.perforTypes=[],s.value.performanceTags=[],s.value.actIDs=[],s.value.performanceIDs=[]},r=i=>{s.value.stages=i.stages||[],s.value.stageTypes=i.stageTypes||[],s.value.categories=i.categories||[],s.value.actTypes=i.actTypes||[],s.value.perforTypes=i.perforTypes||[],s.value.performanceTags=i.performanceTags||[],s.value.searchQuery=i.searchQuery||"",s.value.actIDs=i.actIDs||[],s.value.performanceIDs=i.performanceIDs||[],a.stages=[...s.value.stages],a.stageTypes=[...s.value.stageTypes],a.categories=[...s.value.categories],a.actTypes=[...s.value.actTypes],a.perforTypes=[...s.value.perforTypes],a.performanceTags=[...s.value.performanceTags],a.searchQuery=s.value.searchQuery},S=D(()=>y.value?{...s.value,performanceIDs:k.value.map(i=>String(i.id))}:s.value),k=D(()=>{const i=JSON.parse(localStorage.getItem("event")||"[]");return!d.value||d.value.length===0?(console.warn("Performances data not available yet!"),[]):d.value.filter(w=>i.includes(w.id.toString()))});return(i,w)=>(o(),l("div",null,[v("div",null,[V($(se,{onApply:m},null,512),[[q,_.value==="true"]])]),v("div",ne,[p.value?(o(),P(ae,{key:0,showStageFilter:!0,showStageTypeFilter:!0,showCategoryFilter:!0,showActTypeFilter:!0,showPerforTypeFilter:!0,showPerformanceTagFilter:!0,"initial-stages":a.stages,"initial-stage-types":a.stageTypes,"initial-categories":a.categories,"initial-act-types":a.actTypes,"initial-perfor-types":a.perforTypes,"initial-performance-tags":a.performanceTags,"initial-search-query":a.searchQuery,onApply:r,onClose:w[0]||(w[0]=t=>p.value=!1)},null,8,["initial-stages","initial-stage-types","initial-categories","initial-act-types","initial-perfor-types","initial-performance-tags","initial-search-query"])):K("",!0),$(F,{targetView:"table",class:"schedul-btn"}),v("button",{onClick:w[1]||(w[1]=t=>p.value=!0),class:"open-filter schedul-btn"},T(i.$t("open-filter")),1)]),$(te,{filters:S.value,class:"ProgrammList"},null,8,["filters"])]))}}),le=E(oe,[["__scopeId","data-v-46ab7d3c"]]),ie={class:"table-content"},ce={class:"timeline"},ue={class:"timeline-column"},ve={class:"timeline-header"},pe={class:"stages"},de={class:"timeline-header"},ge={key:0},me={key:1},ye={key:2},he=M({__name:"ScheduleTableItem",props:{date:String},setup(b){const d=b,{performances:g,acts:_,stages:y}=x(),p=t=>X(t,_),a=D(()=>g.value.filter(t=>{const n=h(t.start_time),u=h(d.date),c=n.getHours()<A&&n.getDate()===u.getDate()+1,f=n.getDate()===u.getDate()||c;return n.getHours()<A&&n.getDate()===u.getDate()?!1:f}).sort((t,n)=>{const u=h(t.start_time)??new Date(0),c=h(n.start_time)??new Date(0);return u.getTime()-c.getTime()})),m=D(()=>y.value.filter(t=>a.value.some(n=>n.stageID===t.id))),r=D(()=>{const n=a.value.flatMap(e=>[h(e.start_time).getHours(),h(e.end_time).getHours()]).map(e=>e<A?e+24:e),u=Math.min(...n)-1,c=Math.max(...n)+1;return Array.from({length:c-u+1},(e,f)=>(u+f)%24)}),S=t=>{const n=h(t.start_time),u=h(t.end_time),c=r.value[0],e=r.value.length*60,f=(n.getHours()<c?n.getHours()+24:n.getHours())*60+n.getMinutes()-c*60,N=(u.getHours()<c?u.getHours()+24:u.getHours())*60+u.getMinutes()-c*60,Q=f/e*100,z=(N-f)/e*100,O=1,R=r.value.length*60,G=O/R*100;return{top:`${Q}%`,height:`calc(${z}% - ${G}%)`}},k=()=>{const t=r.value[0];return{height:`${((r.value[r.value.length-1]<t?r.value[r.value.length-1]+24:r.value[r.value.length-1])-t+1)*60}px`}},i=t=>{const n=r.value[0],u=r.value.length*60;return{top:((t<n?t+24:t)*60-n*60)/u*100+"%"}},w=t=>["concert","spezial","workshop","Musik","Kunst","Gesellschaft","Sport","Wirtschaft"].includes(t)?t:"default";return(t,n)=>{const u=Y("router-link");return o(),l("div",ie,[v("div",ce,[v("div",ue,[v("div",ve,T(t.$t("Time")),1),v("div",{class:"time-slots",style:H(k())},[(o(!0),l(I,null,C(r.value,c=>(o(),l("div",{key:c,class:"time-slot",style:H(i(c))},T(c%24)+":00 ",5))),128))],4)])]),v("div",pe,[(o(!0),l(I,null,C(m.value,c=>(o(),l("div",{key:c.id,class:"stage"},[v("div",de,T(c.name),1),v("div",{class:"events",style:H(k())},[(o(!0),l(I,null,C(r.value,e=>(o(),l("div",{key:e,class:"time-slot",style:H(i(e))},null,4))),128)),(o(!0),l(I,null,C(a.value.filter(e=>e.stageID===c.id),e=>{var f;return o(),P(u,{key:e.id,to:"/event/"+(((f=e["id-name"])==null?void 0:f.trim())||e.id),class:j(["event",w(e==null?void 0:e.type)]),style:H(S(e)),title:e.name||p(e.actsIDArr)||t.$t("Unknown")},{default:W(()=>[v("strong",null,[e.name?(o(),l("div",ge,T(e.name),1)):e.actsIDArr.length?(o(),l("div",me,T(p(e.actsIDArr)),1)):(o(),l("div",ye,T(t.$t("Unknown")),1))])]),_:2},1032,["to","class","style","title"])}),128))],4)]))),128))])])}}}),_e=E(he,[["__scopeId","data-v-a9a8767a"]]),fe={class:"timetable"},Te={class:"group-head"},De={class:"date-nav-container"},Se=["onClick"],we={key:1,class:"nav-arrow nav-left"},ke=["id"],$e=["onClick"],be={key:3,class:"nav-arrow nav-right"},Ie=M({__name:"ScheduleTable",setup(b){const d=L();function g(p){d.replace({hash:`#${p}`,query:{...d.currentRoute.value.query}});const a=document.getElementById(p);a&&a.scrollIntoView({behavior:"smooth"})}const{performances:_}=x(),y=D(()=>{const p=new Set(_.value.map(m=>h(m.start_time).toLocaleDateString("en-CA"))),a=new Set;return _.value.forEach(m=>{const r=h(m.start_time),S=r.getHours();if(S>=0&&S<A){const k=new Date(r);k.setDate(r.getDate()-1),a.add(k.toLocaleDateString("en-CA"))}}),Array.from(new Set([...p,...a])).sort()});return(p,a)=>(o(),l(I,null,[$(F,{targetView:"list"}),v("div",fe,[(o(!0),l(I,null,C(y.value,(m,r)=>(o(),l("div",{key:m,class:"day-table"},[v("div",Te,[v("div",De,[r>0?(o(),l("button",{key:0,class:"nav-arrow nav-left",onClick:S=>g(y.value[r-1])}," < ",8,Se)):(o(),l("div",we)),v("h2",{class:"head-date",id:m},T(Z(ee)(m,"Date Long")),9,ke),r<y.value.length-1?(o(),l("button",{key:2,class:"nav-arrow nav-right",onClick:S=>g(y.value[r+1])}," > ",8,$e)):(o(),l("div",be))])]),$(_e,{date:m},null,8,["date"])]))),128))])],64))}}),He=E(Ie,[["__scopeId","data-v-708cb6ff"]]),qe=M({__name:"ScheduleView",setup(b){const d=B();L();const g=D(()=>d.query.view??"list");return(_,y)=>(o(),l("div",null,[V(v("div",null,[$(le)],512),[[q,g.value==="list"]]),V(v("div",null,[$(He)],512),[[q,g.value==="table"]])]))}});export{qe as default};
