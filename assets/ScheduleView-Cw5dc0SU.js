import{d as P,a as u,t as p,m as j,p as J,o as r,_ as q,r as M,c as b,b as e,F as k,q as I,u as K,s as Q,v as X,w as L,x as Y,y as d,g as E,z as U,A as G,B as Z,C as D,D as N,n as V,E as ee,G as te,H as se}from"./index-DJwS_xp8.js";import{S as ae}from"./ScheduleListItem-Cm0W8lyW.js";import{u as B}from"./useEventData--7t0jA-N.js";import{T as R}from"./tagLabel-BQPnEk09.js";import{S as ne}from"./SearchBar-DSEzxOv6.js";import"./FavBtn-ChNJu9H2.js";const re=P({__name:"SwitchView",props:{targetView:{}},setup(A){const _=A,y=j(),S=J(),h=()=>{y.replace({query:{...S.query,view:_.targetView}})};return(g,o)=>(r(),u("button",{onClick:h,class:"btn-view-chang"},p(g.$t("change-view")),1))}}),W=q(re,[["__scopeId","data-v-37e30bd6"]]),le={class:"overlay"},oe={class:"filter-modal"},ie={class:"filter-modal-header"},ce={class:"filter-modal-body"},ue={class:"filter-group"},de={class:"filter-button-group"},ve=["onClick"],me={class:"filter-group"},ge={class:"filter-button-group"},pe={class:"filter-group"},fe={class:"filter-button-group"},_e={class:"filter-group"},ye={class:"filter-button-group"},he={class:"filter-modal-footer"},Se=P({__name:"FilterMenu",props:{initialStages:{type:Array,default:()=>[]},initialCategories:{type:Array,default:()=>[]},initialTypes:{type:Array,default:()=>[]},initialPerformanceTags:{type:Array,default:()=>[]},initialSearchQuery:{type:String,default:""}},emits:["apply","close"],setup(A,{emit:_}){const y=_,{stages:S,acts:h,performances:g}=B(),o=A,i=M([...o.initialStages.map(Number)]),T=M([...o.initialCategories]),w=M([...o.initialTypes]),C=M([...o.initialPerformanceTags]),v=M(o.initialSearchQuery),s=b(()=>{const a=new Set;return h.value.forEach(f=>{var n;(n=f.tags)==null||n.forEach(H=>{H.visible&&a.add(H.name)})}),Array.from(a)}),l=b(()=>{const a=new Set;return g.value.forEach(f=>{f.type&&a.add(f.type)}),Array.from(a)}),m=b(()=>{const a=new Set;return g.value.forEach(f=>{var n;(n=f.tags)==null||n.forEach(H=>a.add(H))}),Array.from(a)}),c=(a,f)=>{const n=a.indexOf(f);n>=0?a.splice(n,1):a.push(f)},t=a=>c(i.value,a),$=a=>c(T.value,a),x=a=>c(w.value,a),z=a=>c(C.value,a),O=()=>{i.value=[],T.value=[],w.value=[],C.value=[],v.value=""},F=()=>{y("apply",{stages:i.value.map(String),categories:T.value,types:w.value,performanceTags:C.value,searchQuery:v.value.trim()}),y("close")};return(a,f)=>(r(),u("div",le,[e("div",oe,[e("div",ie,[e("h2",null,p(a.$t("filter")),1),e("button",{onClick:f[0]||(f[0]=n=>a.$emit("close")),class:"filter-close-btn"},"×")]),e("div",ce,[e("button",{onClick:O,class:"filter-reset-btn"}," ↻ "+p(a.$t("reset-filter")),1),e("div",ue,[e("h3",null,p(a.$t("stages")),1),e("div",de,[(r(!0),u(k,null,I(K(S),n=>(r(),u("button",{key:n.id,onClick:H=>t(n.id),class:Q({selected:i.value.includes(n.id)})},[f[1]||(f[1]=e("span",null,"📍",-1)),X(" "+p(n.name),1)],10,ve))),128))])]),e("div",me,[e("h3",null,p(a.$t("kategorien")),1),e("div",ge,[(r(!0),u(k,null,I(s.value,n=>(r(),L(R,{key:n,name:n,tag:"button",onClick:H=>$(n),class:Q({selected:T.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",pe,[e("h3",null,p(a.$t("Performance-Types")),1),e("div",fe,[(r(!0),u(k,null,I(l.value,n=>(r(),L(R,{key:n,name:n,tag:"button",onClick:H=>x(n),class:Q({selected:w.value.includes(n)})},null,8,["name","onClick","class"]))),128))])]),e("div",_e,[e("h3",null,p(a.$t("Performance-Tags")),1),e("div",ye,[(r(!0),u(k,null,I(m.value,n=>(r(),L(R,{key:n,name:n,tag:"button",onClick:H=>z(n),class:Q({selected:C.value.includes(n)})},null,8,["name","onClick","class"]))),128))])])]),e("div",he,[e("button",{onClick:F,class:"filter-apply-btn"},p(a.$t("apply-filter")),1)])])]))}}),Te=q(Se,[["__scopeId","data-v-99d9e48d"]]),$e={class:"btn-header"},be=P({__name:"ScheduleList",setup(A){const{performances:_}=B(),y=J(),S=b(()=>y.query.search??"false"),h=b(()=>y.query.fav==="true"),g=M(!1),o=Y({stages:[],categories:[],types:[],performanceTags:[],searchQuery:""}),i=v=>{d.value.searchQuery=v,d.value.stages=[],d.value.categories=[],d.value.types=[],d.value.performanceTags=[],d.value.actIDs=[],d.value.performanceIDs=[]},T=v=>{d.value.stages=v.stages||[],d.value.categories=v.categories||[],d.value.types=v.types||[],d.value.performanceTags=v.performanceTags||[],d.value.searchQuery=v.searchQuery||"",d.value.actIDs=v.actIDs||[],d.value.performanceIDs=v.performanceIDs||[],o.stages=[...d.value.stages],o.categories=[...d.value.categories],o.types=[...d.value.types],o.performanceTags=[...d.value.performanceTags],o.searchQuery=d.value.searchQuery},w=b(()=>h.value?{...d.value,performanceIDs:C.value.map(v=>String(v.id))}:d.value),C=b(()=>{const v=JSON.parse(localStorage.getItem("event")||"[]");return!_.value||_.value.length===0?(console.warn("Performances data not available yet!"),[]):_.value.filter(s=>v.includes(s.id.toString()))});return(v,s)=>(r(),u("div",null,[e("div",null,[U(E(ne,{onApply:i},null,512),[[G,S.value==="true"]])]),e("div",$e,[g.value?(r(),L(Te,{key:0,"initial-stages":o.stages,"initial-categories":o.categories,"initial-types":o.types,"initial-performance-tags":o.performanceTags,"initial-search-query":o.searchQuery,onApply:T,onClose:s[0]||(s[0]=l=>g.value=!1)},null,8,["initial-stages","initial-categories","initial-types","initial-performance-tags","initial-search-query"])):Z("",!0),E(W,{targetView:"table",class:"schedul-btn"}),e("button",{onClick:s[1]||(s[1]=l=>g.value=!0),class:"open-filter schedul-btn"},p(v.$t("open-filter")),1)]),E(ae,{filters:w.value,class:"ProgrammList"},null,8,["filters"])]))}}),De=q(be,[["__scopeId","data-v-f21c754a"]]),ke={class:"table-content"},we={class:"timeline"},Ce={class:"timeline-column"},Ie={class:"timeline-header"},Ae={class:"stages"},He={class:"timeline-header"},Ee={key:0},Me={key:1},Pe={key:2},Ve=P({__name:"ScheduleTableItem",props:{date:String},setup(A){const _=A,{performances:y,acts:S,stages:h}=B(),g=s=>te(s,S),o=b(()=>y.value.filter(s=>{const l=D(s.start_time),m=D(_.date),c=l.getHours()<N&&l.getDate()===m.getDate()+1,$=l.getDate()===m.getDate()||c;return l.getHours()<N&&l.getDate()===m.getDate()?!1:$}).sort((s,l)=>{const m=D(s.start_time)??new Date(0),c=D(l.start_time)??new Date(0);return m.getTime()-c.getTime()})),i=b(()=>{const l=o.value.flatMap(t=>[D(t.start_time).getHours(),D(t.end_time).getHours()]).map(t=>t<N?t+24:t),m=Math.min(...l)-1,c=Math.max(...l)+1;return Array.from({length:c-m+1},(t,$)=>(m+$)%24)}),T=s=>{const l=D(s.start_time),m=D(s.end_time),c=i.value[0],t=i.value.length*60,$=(l.getHours()<c?l.getHours()+24:l.getHours())*60+l.getMinutes()-c*60,x=(m.getHours()<c?m.getHours()+24:m.getHours())*60+m.getMinutes()-c*60,z=$/t*100,O=(x-$)/t*100,F=1,a=i.value.length*60,f=F/a*100;return{top:`${z}%`,height:`calc(${O}% - ${f}%)`}},w=()=>{const s=i.value[0];return{height:`${((i.value[i.value.length-1]<s?i.value[i.value.length-1]+24:i.value[i.value.length-1])-s+1)*60}px`}},C=s=>{const l=i.value[0],m=i.value.length*60;return{top:((s<l?s+24:s)*60-l*60)/m*100+"%"}},v=s=>["concert","spezial","workshop"].includes(s)?s:"default";return(s,l)=>{const m=se("router-link");return r(),u("div",ke,[e("div",we,[e("div",Ce,[e("div",Ie,p(s.$t("Time")),1),e("div",{class:"time-slots",style:V(w())},[(r(!0),u(k,null,I(i.value,c=>(r(),u("div",{key:c,class:"time-slot",style:V(C(c))},p(c%24)+":00 ",5))),128))],4)])]),e("div",Ae,[(r(!0),u(k,null,I(K(h),c=>(r(),u("div",{key:c.id,class:"stage"},[e("div",He,p(c.name),1),e("div",{class:"events",style:V(w())},[(r(!0),u(k,null,I(i.value,t=>(r(),u("div",{key:t,class:"time-slot",style:V(C(t))},null,4))),128)),(r(!0),u(k,null,I(o.value.filter(t=>t.stageID===c.id),t=>{var $;return r(),L(m,{key:t.id,to:"/event/"+((($=t["id-name"])==null?void 0:$.trim())||t.id),class:Q(["event",v(t==null?void 0:t.type)]),style:V(T(t)),title:t.name||g(t.actsIDArr)||s.$t("Unknown")},{default:ee(()=>[e("strong",null,[t.name?(r(),u("div",Ee,p(t.name),1)):t.actsIDArr.length?(r(),u("div",Me,p(g(t.actsIDArr)),1)):(r(),u("div",Pe,p(s.$t("Unknown")),1))])]),_:2},1032,["to","class","style","title"])}),128))],4)]))),128))])])}}}),Qe=q(Ve,[["__scopeId","data-v-96ac454f"]]),Le={class:"timetable"},qe={class:"day-head"},Ne=P({__name:"ScheduleTable",setup(A){const{performances:_}=B(),y=b(()=>{const S=new Set(_.value.map(g=>D(g.start_time).toLocaleDateString("en-CA"))),h=new Set;return _.value.forEach(g=>{const o=D(g.start_time),i=o.getHours();if(i>=0&&i<N){const T=new Date(o);T.setDate(o.getDate()-1),h.add(T.toLocaleDateString("en-CA"))}}),Array.from(new Set([...S,...h])).sort()});return(S,h)=>(r(),u(k,null,[E(W,{targetView:"list"}),e("div",Le,[(r(!0),u(k,null,I(y.value,g=>(r(),u("div",{key:g,class:"day-table"},[e("h2",qe,p(g),1),E(Qe,{date:g},null,8,["date"])]))),128))])],64))}}),Be=q(Ne,[["__scopeId","data-v-c010b49a"]]),Ge=P({__name:"ScheduleView",setup(A){const _=J();j();const y=b(()=>_.query.view??"list");return(S,h)=>(r(),u("div",null,[U(e("div",null,[E(De)],512),[[G,y.value==="list"]]),U(e("div",null,[E(Be)],512),[[G,y.value==="table"]])]))}});export{Ge as default};
